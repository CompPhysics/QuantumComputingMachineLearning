TITLE: March 13-17,2023: Quantum Computing, Quantum Machine Learning and Quantum Information Theories
AUTHOR: Morten Hjorth-Jensen {copyright, 1999-present|CC BY-NC} at Department of Physics, University of Oslo & Department of Physics and Astronomy and National Superconducting Cyclotron Laboratory, Michigan State University
DATE: today


!split
===== Solving quantum mechanical problems  =====

!bblock 
  o Simple Hamiltonian, the Lipkin model
  o Introducing the Variational Quantum Eigensolver (VQE)
  o Analyzing the solution of eigenvalue problems using the Lipkin model
!eblock


!split
===== Simple Hamiltonian, the Lipkin model =====

We will study a schematic model (the Lipkin model, Nucl.
Phys. {\bf 62} (1965) 188) for the interaction among  $4$
fermions that can occupy two different energy levels. Each levels has degeneration $d=4$. The two levels have quantum numbers $\sigma=\pm 1$,
with the upper level having  $\sigma=+1$ and energy
$\varepsilon_{1}=
\varepsilon/2$. The lower level  has $\sigma=-1$ and energy
$\varepsilon_{2}=-\varepsilon/2$. 
In addition, the substates  of each level are characterized  
by the quantum numbers $p=1,2,3,4$.

We define the single-particle states
!bt
\[
\ket{u_{\sigma =-1,p}}=a_{-p}^{\dagger}\ket{0}
\hspace{1cm}
\ket{u_{\sigma =1,p}}=a_{+p}^{\dagger}\ket{0}.
\]
!et
The single-particle states span an orthonormal basis.
The Hamiltonian of the system is given by

!bt
\[
\begin{array}{ll}
\hat{H}=&\hat{H}_{0}+\hat{H}_{1}+\hat{H}_{2}\\
&\\
\hat{H}_{0}=&\frac{1}{2}\varepsilon\sum_{\sigma ,p}\sigma
a_{\sigma,p}^{\dagger}a_{\sigma ,p}\\
&\\
\hat{H}_{1}=&\frac{1}{2}V\sum_{\sigma ,p,p'}
a_{\sigma,p}^{\dagger}a_{\sigma ,p'}^{\dagger}
a_{-\sigma ,p'}a_{-\sigma ,p}\\
&\\
\hat{H}_{2}=&\frac{1}{2}W\sum_{\sigma ,p,p'}
a_{\sigma,p}^{\dagger}a_{-\sigma ,p'}^{\dagger}
a_{\sigma ,p'}a_{-\sigma ,p}\\
&\\
\end{array}
\]
!et
where $V$ and $W$ are constants. The operator 
$H_{1}$ can move pairs of fermions
while $H_{2}$ is a spin-exchange term. The latter
moves a pair of fermions from a state $(p\sigma ,p' -\sigma)$ to a state
$(p-\sigma ,p'\sigma)$.


Introduce the quasispin operators
!bt
\[
\begin{array}{ll}
\hat{J}_{+}=&\sum_{p}
a_{p+}^{\dagger}a_{p-}\\
&\\
\hat{J}_{-}=&\sum_{p}
a_{p-}^{\dagger}a_{p+}\\
&\\
\hat{J}_{z}=&\frac{1}{2}\sum_{p\sigma}\sigma
a_{p\sigma}^{\dagger}a_{p\sigma}\\
&\\
\hat{J}^{2}=&J_{+}J_{-}+J_{z}^{2}-J_{z}\\
&\\
\end{array}
\]
!et
Show that these operators obey the commutation relations for angular momentum.
\paragraph{Number operator}
Express $\hat{H}$ in terms of the above quasispin operators and the number operator
!bt
\[
\hat{N}=\sum_{p\sigma}
a_{p\sigma}^{\dagger}a_{p\sigma}.
\]
!et
\paragraph{Commutation relations}
Show that $\hat{H}$ commutes with $J^{2}$, viz., $J$ is a good quantum number. Does it commute with $J_z$?
\paragraph{Wick's theorem}
Consider thereafter a state with all four fermions in the lowest level (see the above figure).
We can write this state as
!bt
\[
\ket{\Phi_0}=\ket{\Phi_{J_z=-2}} =a_{1-}^{\dagger}a_{2-}^{\dagger}
a_{3-}^{\dagger}a_{4-}^{\dagger}\ket{0}.
\]
!et
This state has $J_{z}=-2$ (convince yourself about this) and belongs
to the set of possible projections of $J=2$.  We introduce the
shorthand notation $\ket{J,J_z}$ for states with different values of
spin $J$ and its projection $J_z$.  We can think of this as our
computational basis for $J=2$ and all five projections $J_z$.  We will
also assume that the state $\Phi_0$ can be considered as an ansatz for
the ground state of the system.





!split
===== Variational Quantum Eigensolver =====


!split
===== Analyzing the soltuion of the eigenavlue problems with the Lipkin model =====

!bc pycod 
import numpy as np
import qiskit
from qiskit.visualization import circuit_drawer
from qiskit.quantum_info import Statevector
from matplotlib.pyplot import figure
from qiskit import QuantumRegister, QuantumCircuit, ClassicalRegister, Aer, assemble
from qiskit.providers.aer.noise import NoiseModel
import pylatexenc
from qiskit.algorithms import VQE
from qiskit.utils import QuantumInstance
from qiskit.opflow import X, Z, I, Y
from qiskit.circuit import Parameter
from qiskit.algorithms.optimizers import ADAM
from qiskit.opflow import AerPauliExpectation
from qiskit import IBMQ
import cmath
import pandas as pd
from scipy.sparse import diags
import numpy.linalg as LA
import matplotlib.pyplot as plt
from IPython.display import Image
import warnings
warnings.filterwarnings('ignore')
pi=np.pi
!ec

=== Lipkin Model ===

The Lipkin Model (LM) was introduced by H. Lipkin, N. Meshkov, and A. Glick in 1965. The model considers two levels above and bellow the fermi level to which they are assigned an index of $\sigma_{\pm}$ each with degeneracy $\Omega$ over which fermions are distributed. Using the language of second quantunization representation, the LM
 
!bt
\begin{equation}
     \hat{H}_{LM} = \frac{1}{2}\epsilon\sum_{m\sigma}a^{\dagger}_{m\sigma}a_{m\sigma} -\frac{1}{2}V\sum_{mm'\sigma}a^{\dagger}_{m\sigma}a^{\dagger}_{m'\sigma}a_{m'-\sigma}a_{m-\sigma},
\end{equation}
!et 
where $\epsilon$ is the energy of the level, $V$ is the interaction
strength, and $m=1,\cdots,\Omega$. The first term is a one-body
interaction which counts the number of nucleons in the level. Where
the second term is a two-body interaction that destroys and created
nucleons up and down a level. One can introduce the quasi-spin
operators defined as


!bt 
\begin{equation}
     \begin{split}
         \hat{K}_0 &= \frac{1}{2}\sum_{m=1}^{\Omega}(a^{\dagger}_{m+}a_{m+}-a^{\dagger}_{m-}a_{m-})\\ 
         \hat{K}_+ & = \sum_{m=1}^{\Omega}a^{\dagger}_{m+}a_{m-}\\
         \hat{K}_- & = (\hat{K}_+)^\dagger.
     \end{split}
\end{equation}
!et

These operators have the following SU(2) angular momentum commutation relation
!bt
\begin{equation}
     [\hat{K}_+,\hat{K}_-] =2\hat{K}_0, \hspace{1cm} [\hat{K}_0,\hat{K}_{\pm}]=\pm\hat{K}_{\pm}.
\end{equation}
!et
The LM Hammiltonian can be written using the quasi-spin operators as such
!bt
\begin{equation}
     \hat{H}_{LM} = \epsilon\hat{K}_0 -\frac{1}{2}V(\hat{K}_+\hat{K}_++\hat{K}_-\hat{K}_-).
\end{equation}
!et
The quasi-spin operators act like lowering and raising angular momentum operators, as such they have these given properties
!bt
\begin{equation}
\hat{K}_0|KK_0\rangle = K_0|KK_0\rangle
\end{equation}
!et
!bt
\begin{equation}
    \hat{K}_{\pm}|KK_0\rangle =\sqrt{K(K+1)-K_0(K_0\pm 1)}|KK_0+1\rangle,
\end{equation}
!et
With these properties we can calculate the LM Hamiltonian matrix
!bt
\begin{equation}
\langle KK_0|H_{LM}|KK_0'\rangle,
\end{equation}
!et
where the non-zero elements are given by
!bt
\begin{equation}
\begin{split}
    \langle KK_0|H_{LM}|KK_0'\rangle & = \epsilon K_0\\
     \langle KK_0|H_{LM}|KK_0'\pm 2\rangle & = \langle KK_0\pm 2|H_{LM}|KK_0'\rangle \\
     &= -\frac{1}{2}VC,
\end{split}
\end{equation}
!et
where C is the Clebsch-Gordan Coefficients one gets when $K_{\pm}^2$ operates on the state $|KK_0\rangle$.
Using equation (8) one can calculate the exact solution to the Lipkin Model for any $\Omega$.
 
The collective space of the Hamiltonian is $\Omega+1=3$, and is given by
!bt
\begin{equation}
\begin{pmatrix}-\epsilon & 0 & -V\\
 0&0&0\\
 -V&0&\epsilon
\end{pmatrix}
\end{equation}
!et


!bc pycod 
#function that sorts eigenvalues with its eigenvectors in accending order
def eigen(A):
    eigenValues, eigenVectors = LA.eig(A)
    idx = np.argsort(eigenValues)
    eigenValues = eigenValues[idx]
    eigenVectors = eigenVectors[:,idx]
    return (eigenValues, eigenVectors) 

#one body expectation value
def one_body(E,N):
  k = N/2
  m = np.arange(-k,k+1,1) # Since the collective space is Omega+1
  return E*np.diag(m) #return a matrix where its diagonal elemens are epsilon*K_0

#two body expectation value
def two_body(V,N):
  k = N/2
  m = np.arange(-k,k+1,1)
  left =np.zeros(len(m)-2,dtype=complex)
  right = np.zeros(len(m)-2,dtype=complex)
  diag = np.zeros(len(m),dtype=complex)
  for i in range(len(left)):
    CG = cmath.sqrt(k*(k+1)-(m[i]+2)*(m[i]+1))*cmath.sqrt(k*(k+1)-m[i]*(m[i]+1)) #calculate Clebsch-Gordan Coefficients 
    left[i] = CG
    right[i] = CG
  k = [left,diag,right]
  offset = [-2,0,2]
  return -0.5*V*diags(k,offset).toarray() #return a matrix where its off digonal elements are (1/2)V(K^2_+ + K^2_-)

#full expectation value
def quasi_spin(E,V,N):
  ob = one_body(E,N)
  tb = two_body(V,N)
  H = ob+tb 
  e,v = eigen(H) # find the eigenvalues of the Hamiltonian
  return e,H

#converts chi to V
def Vp(E,omega,chi):
  return (chi*E)/(omega-1)

!ec


!bc pycod 
#parameters
E = 1
chi = np.arange(0,2.1,0.1)
omega = 2

EV0 = []
EV1 = []
EV2 = []
Ham = []
for i in chi:
  v = Vp(E,omega,i)
  EigenV,H = quasi_spin(E,v,omega) #return eigenvalues and Hamiltonian
  Ham.append(H)
  EV0.append(EigenV[0])
  EV1.append(EigenV[1])
  EV2.append(EigenV[2])
!ec



!bc pycod 
matrix = pd.DataFrame(Ham[5].real)
print('Hamiltonian matrix')
matrix.head()
!ec



!bc pycod 
plt.plot(chi,EV0)
plt.plot(chi,EV1)
plt.plot(chi,EV2)
plt.xlabel('$\chi$')
plt.ylabel('Energy')
plt.title('$\Omega=2$ exact Lipkin Model')
!ec

=== Hartree Fock ===
A variational method in quantum mechanics, starts with the Schrodinger equation where one minimizes the energy for a given trail wave function $|\psi\rangle$.

!bt
\begin{equation}
\delta\frac{\langle\psi |\hat{H}|\psi\rangle}{\langle\psi|\psi\rangle}=0
\end{equation}
!et

The Hartree Fock (HF) method is a variational method that assumes that
the exact N-body wavefunction of the system can be approimated by a
single Slater determinant, where energy of the system is minimized and
the trial wave function is the particle number conserving coherent
product state. The SU(2) coherent states map a two-dimensional sphere
known as the bloch sphere onto the complex plane,

!bt
\begin{equation}
\tau = tan\frac{\theta}{2}e^{-i\phi}
\end{equation}
!et
where the normalized coherent SU(2) state can be written in the language of LM:
!bt
\begin{equation}
|\tau\rangle = \frac{1}{(1+|\tau|^2)^{\Omega/2}}e^{\tau\hat{K}_+}|\frac{\Omega}{2},-\frac{\Omega}{2}\rangle,
\end{equation}
!et
The $E_{g.s}$ of the LM given HF coherent states is:
!bt
\begin{equation}
E(\tau) = \langle \tau|\hat{H}_{LM}|\tau\rangle.
\end{equation}
!et
To calculate equation the last euation, we use generating functions for:
!bt
\begin{equation}
\begin{split}
\langle \tau|\hat{K}_{0}|\tau\rangle &= \frac{1}{2}\Omega\frac{|\tau|^2-1}{\tau|^2+1}\\
\langle \tau|\hat{K}_{\pm}^2|\tau\rangle &= \Omega\frac{\tau^*}{|\tau|^2+1}
\end{split}
\end{equation}
!et
Then using the definition of $\tau$ in equation (10) we can write down the energy:
!bt
\begin{equation}
E(\tau) = -\frac{\epsilon}{2}\Omega(cos\theta+\frac{\chi}{2}sin^2\theta cos2\phi),
\end{equation}
!et
where $\chi=\frac{V}{\epsilon}(\Omega-1)$. Minimizing $E(\tau)$ with respect to $\theta,\phi$, we obtain the ground state Hartree Fock energy
!bt
\begin{equation}
\begin{split}
E_{HF}  = -\frac{\Omega}{2}\epsilon &\hspace{1cm} \chi<1\\
E_{HF}  = -\frac{\Omega}{4}\epsilon(\chi+\frac{1}{\chi}) &\hspace{1cm} \chi\ge 1
\end{split}
\end{equation}
!et


!bc pycod 
def E_HF(x,E,omega):
  if x < 1:
    EHF = -(omega/2)*E
  elif x >= 1:
    EHF = -(omega/4)*E*(x+(1/x))
  return EHF
!ec



!bc pycod 
epsilon = 1
Omega = 2

HF = []
exact = []
for x in chi:
    HF.append(E_HF(x,epsilon,omega).real)
    v = Vp(epsilon,omega,x)
    e,h = quasi_spin(epsilon,v,omega)
    exact.append(e[0].real)
!ec



!bc pycod 
plt.plot(chi,HF,label='HF')
plt.plot(chi,exact,label='exact')
plt.xlabel('$\chi$')
plt.ylabel('Energy')
plt.axvline(1, color = 'k', linestyle='--')
plt.title('$\Omega=2$ exact Lipkin Model')
plt.legend(bbox_to_anchor=(1.05, 1))
!ec



=== Quantum Circuit ===

To solve the LM on a quantum computer we have to solve Schrodinger's equation. 
!bt
\begin{equation}
H|\psi(\tilde{\theta})\rangle = E|\psi(\tilde{\theta})\rangle\\
\end{equation}
!et
We map the creation and annihilation operators to Pauli operators Z, X, Y using the Jordan-Wigner transformation. The Hamiltonian then takes the form of
!bt
\begin{equation}
H = \frac{\epsilon}{2}(Z_1+Z_1) - \frac{V}{2}(X_1X_2 - Y_1Y_2),
\end{equation}
!et
where the Pauli operators are the measurement basis which the quantum
circuit is measured in. However, before measuring, we first have to
prepare the initial state $|\psi(\tilde{\theta})\rangle$ for
$\Omega=2$ of the LM circuit
!bt
\begin{equation}
|\psi(\tilde{\theta})\rangle = cos(\tilde{\theta})|00\rangle+sin(\tilde{\theta})|11\rangle,
end{equation}
!et
where $|00\rangle =|\uparrow\uparrow\rangle$, $|11\rangle=|\downarrow\downarrow\rangle$, and $\tilde{\theta}=\theta-\frac{\pi}{2}$. 

This type of problem resides in the pantheon of variational methods
where we minimize $\tilde{\theta}$. This problem was coded using IBM's
python library Qiskit. Since this is a variational problem, the use of
Qiskit's Variational Quantum Eigensolver (VQE) was used to find the
optimal $\tilde{\theta}$ that minimizes
$\langle\psi(\tilde{\theta})|H|\psi(\tilde{\theta})\rangle$.


!bc pycod 
def LM_circuit():
    theta = Parameter('theta')
    QC = QuantumCircuit(2)
    QC.ry(2*(theta-np.pi/2),0)
    QC.cnot(0,1)
    return QC
!ec



!bc pycod 
QC = LM_circuit()
QC.draw(output='mpl')
!ec

=== VQE method 1 ===

For this method, we will be using Qiskit's VQE function, where we specifiy 
* Quantum circuit
  o Optimizer
  o Quantum instance (i.e. which backend). Here we will be using the "qasm_simulator" 
  o Initial point (i.e. $\theta$ search space)
  o Hamiltonian/measurement basis
 
To define the Hamiltonian, we will use qiskit Pauli operator functions
I,Z,X,Y.  In this method, for a given $\chi$, we will do a search over
$\theta$ from $-\frac{\pi}{2}$ to $\frac{\pi}{2}$ and picking out the
minimum energy value

!bc pycod
#sim1 min example
sim = Aer.get_backend('qasm_simulator')
adam =qiskit.algorithms.optimizers.ADAM(maxiter=10000) #optimizer for VQE
epsilon = 1
omega = 2
chi2 = [0.5,1]

t = np.arange(-pi/2,pi/2,0.05) #0.1 step size finishs pretty fast
energy = []
for x in chi2:
    ev = []
    v = Vp(epsilon,omega,x)
    for i in range(len(t)):
        H = 0.5 * epsilon * ( Z ^ I ) +             0.5 * epsilon * ( I ^ Z ) -             0.5 * v * ( X ^ X ) +             0.5 * v * ( Y ^ Y )

        vqe = VQE(ansatz=LM_circuit(),optimizer=adam,initial_point=[t[i]],quantum_instance=sim,expectation=AerPauliExpectation())
        result = vqe.compute_minimum_eigenvalue(H)
        ev.append(result.eigenvalue)
    energy.append(ev)


plt.plot(t,energy[0],label='$\chi=0.5$')
plt.plot(t,energy[1],label='$\chi=1$')

plt.xlabel('$\\theta$')
plt.ylabel('Ground State Energy')
plt.title('$E_{g.s}$ vs. $\\theta$')
plt.legend()
!ec

!bc pycod
epsilon = 1
omega = 2
chi3 = np.arange(0,2.1,0.1)
t = np.arange(-pi/2,pi/2,0.1)
adam =qiskit.algorithms.optimizers.ADAM(maxiter=10000)
LM_sim = []
for x in chi3:
    v = Vp(epsilon,omega,x)
    ev = []
    for i in range(len(t)):
        H = 0.5 * epsilon * ( Z ^ I ) +            0.5 * epsilon * ( I ^ Z ) -            0.5 * v * ( X ^ X ) +            0.5 * v * ( Y ^ Y )
    
        vqe = VQE(ansatz=LM_circuit(),optimizer=adam,initial_point=[t[i]],quantum_instance=sim,expectation=AerPauliExpectation())
        result = vqe.compute_minimum_eigenvalue(H)

        ev.append(result.eigenvalue)
    LM_sim.append(min(ev))

plt.plot(chi,np.array(exact),label='$E_{exact}$',color='b')
plt.plot(chi,np.array(HF),label='$E_{HF}$',color='g')
plt.scatter(chi3,LM_sim,label='QC sim',color='cyan')
plt.axvline(1, color = 'k', linestyle='--')
plt.ylabel('$E_{g.s}$')
plt.xlabel('$\chi$')
plt.title(f'$\Omega=2$')
plt.legend()
!ec

Here we will be running the same code, but with a noise model of IBM Quantum Computer Manila.
Note this code takes a lot longer to run, so maybe reduce range of $\chi$ and $t$ i.e. $\theta$.

!bc pycod
IBMQ.load_account()
provider = IBMQ.get_provider()
IBMQC=provider.get_backend('ibmq_manila')
noise_model = NoiseModel.from_backend(IBMQC)
qi = QuantumInstance(backend=sim, noise_model=noise_model)

epsilon = 1
omega = 2
chi4 = np.arange(0,2.1,0.1)
t = np.arange(-pi/2,pi/2,0.1)
adam =qiskit.algorithms.optimizers.ADAM(maxiter=10000)
LM_sim_noise = []
for x in chi3:
    v = Vp(epsilon,omega,x)
    ev = []
    for i in range(len(t)):
        H = 0.5 * epsilon * ( Z ^ I ) +            0.5 * epsilon * ( I ^ Z ) -            0.5 * v * ( X ^ X ) +            0.5 * v * ( Y ^ Y )
    
        vqe = VQE(ansatz=LM_circuit(),optimizer=adam,initial_point=[t[i]],quantum_instance=qi,expectation=AerPauliExpectation())
        result = vqe.compute_minimum_eigenvalue(H)

        ev.append(result.eigenvalue)
    LM_sim_noise.append(min(ev))


plt.plot(chi,np.array(exact),label='$E_{exact}$',color='b')
plt.plot(chi,np.array(HF),label='$E_{HF}$',color='g')
plt.scatter(chi3,LM_sim,label='QC sim',color='cyan')
plt.scatter(chi4,LM_sim_noise,label='QC sim with noise',color='r')
plt.axvline(1, color = 'k', linestyle='--')
plt.ylabel('$E_{g.s}$')
plt.xlabel('$\chi$')
plt.title(f'$\Omega=2$')
plt.legend()
!ec

=== VQE method 2 ===

For this method, we will be using Qiskit's VQE function, where we specifiy 
o Quantum circuit
o Optimizer
o Quantum instance (i.e. which backend). Here we will be using the "statevector_simulator" 
o Hamiltonian/measurement basis

!bc pycod
epsilon = 1
omega = 2
chi5 = np.arange(0,2.1,0.1)
adam =qiskit.algorithms.optimizers.ADAM(maxiter=10000)
LM_sim = []
for x in chi5:
    v = Vp(epsilon,omega,x)
    
    H = 0.5 * epsilon * ( Z ^ I ) +        0.5 * epsilon * ( I ^ Z ) -        0.5 * v * ( X ^ X ) +        0.5 * v * ( Y ^ Y )
    
    vqe = VQE(ansatz=LM_circuit(),optimizer=adam,quantum_instance=vec,expectation=AerPauliExpectation())
    result = vqe.compute_minimum_eigenvalue(H)
    LM_sim.append(result.eigenvalue)


plt.plot(chi,np.array(exact),label='$E_{exact}$',color='b')
plt.plot(chi,np.array(HF),label='$E_{HF}$',color='g')
plt.scatter(chi5,LM_sim,label='QC state vec',color='cyan')
plt.axvline(1, color = 'k', linestyle='--')
plt.ylabel('$E_{g.s}$')
plt.xlabel('$\chi$')
plt.title('$\Omega=2$')
plt.legend()
!ec

One thing to note is that method 2 only works for simulation. Where
method 1 can work using IBM quantum computers. However, method 2 does
run faster then method 1.

!bblock Lecture next week we discuss the quantum Fourier transform and the phase estimatiaon algorithm
  o Quantum Fourier transform
  o Phase estimation algorithm
  o Second quantization
  o Jordan-Wigner transformation
  o Suzuki-Trotter approximation
!eblock


\section{Kommutasjonsregler for kvasispinnoperatorene}

Jeg har altså følgende kvasispinnoperatorer:
\begin{align}
J_{\pm} = \sum_p a_{p\pm}^\dagger a_{p\mp},
\label{eq:Jpm} \\
%
J_{z} = \frac{1}{2}\sum_{p,\sigma} \sigma a_{p\sigma}^\dagger a_{p\sigma},
\label{eq:Jz} \\
%
J^{2} = J_+ J_- + J_z^2 - J_z,
\label{eq:J2}
\end{align}
%
og jeg skal beregne kommutatorene
\[ [J_z,J_\pm], \quad [J_+,J_-], \quad [J^2,J_\pm] \quad \text{og} \quad 
[J^2,J_z]. \]
%
Jeg begynner med den første, og setter inn for $J_z$ og $J_\pm$ gitt ved henholdsvis ligningene \eqref{eq:Jz} og \eqref{eq:Jpm}:
\begin{align*}
[J_z,J_\pm] &= J_z J_\pm - J_\pm J_z \\
%
&= \left( \frac{1}{2}\sum_{p,\sigma} \sigma a_{p\sigma}^\dagger a_{p\sigma} \right)
\left( \sum_{p'} a_{p'\pm}^\dagger a_{p'\mp} \right) -
\left( \sum_{p'} a_{p'\pm}^\dagger a_{p'\mp} \right)
\left( \frac{1}{2}\sum_{p,\sigma} \sigma a_{p\sigma}^\dagger a_{p\sigma} \right) \\
%
&= \frac{1}{2} \sum_{p,p',\sigma} \sigma \left( a_{p\sigma}^\dagger a_{p\sigma} a_{p'\pm}^\dagger a_{p'\mp} - a_{p'\pm}^\dagger a_{p'\mp} a_{p\sigma}^\dagger a_{p\sigma} \right).
\end{align*}
%
Jeg bruker så antikommutasjonsreglene jeg har for kreasjon- og annihilasjonsoperatorene som er som følger
\begin{align}
\{ a_l,a_k \} &= 0, \label{eq:al,ak} \\
\{ a_l^\dagger , a_k^\dagger \} &= 0, \label{eq:ald,akd} \\
\{ a_l^\dagger , a_k \} &= \delta_{lk}, \label{eq:ald,ak}
\end{align}
for å flytte operatorene i det høyre produktet til samme rekkefølge som de er i det venstre produktet:
%
\begin{align*}
[J_z,J_\pm] &= \frac{1}{2} \sum_{p,p',\sigma} \sigma \left(
a_{p\sigma}^\dagger a_{p\sigma} a_{p'\pm}^\dagger a_{p'\mp} -
a_{p'\pm}^\dagger \left( \delta_{p' p} \delta_{\mp \sigma} - a_{p\sigma}^\dagger a_{p'\mp} \right) a_{p\sigma} \right) \\
%
&= \frac{1}{2} \sum_{p,p',\sigma} \sigma \left(
a_{p\sigma}^\dagger a_{p\sigma} a_{p'\pm}^\dagger a_{p'\mp} -
a_{p'\pm}^\dagger \delta_{p' p} \delta_{\mp \sigma} a_{p\sigma} +
a_{p'\pm}^\dagger a_{p\sigma}^\dagger a_{p'\mp} a_{p\sigma} \right), \\
%
\end{align*}
%
som gir videre
%
\begin{align*}
[J_z,J_\pm]
%
&= \frac{1}{2} \sum_{p,p',\sigma} \sigma \left(
a_{p\sigma}^\dagger a_{p\sigma} a_{p'\pm}^\dagger a_{p'\mp} -
a_{p'\pm}^\dagger \delta_{pp'} \delta_{\mp \sigma} a_{p\sigma} +
a_{p\sigma}^\dagger a_{p'\pm}^\dagger a_{p\sigma} a_{p'\mp} \right) \\
%
&= \frac{1}{2} \sum_{p,p',\sigma} \sigma \left(
a_{p\sigma}^\dagger a_{p\sigma} a_{p'\pm}^\dagger a_{p'\mp} -
a_{p'\pm}^\dagger \delta_{pp'} \delta_{\mp \sigma} a_{p\sigma} +
a_{p\sigma}^\dagger \left( \delta_{pp'} \delta_{\pm \sigma} - a_{p\sigma} a_{p'\pm}^\dagger \right) a_{p'\mp} \right) \\
%
&= \frac{1}{2} \sum_{p,p',\sigma} \sigma \left(
a_{p\sigma}^\dagger \delta_{pp'} \delta_{\pm \sigma} a_{p'\mp} -
a_{p'\pm}^\dagger \delta_{pp'} \delta_{\mp \sigma} a_{p\sigma} \right). \\
\end{align*}
%
Her følger den siste likheten ved at de to jeg nå har klart å få frem leddet lengst til venstre i summen ved å benytte antikommutatorreglene på det opprinnelige høyre leddet, og jeg sitter da igjen med noen ``rester''. Disse to deltafunksjonene fjerner to av de tre summene, og jeg sitter igjen med
%
\begin{align*}
[J_z,J_\pm] &= \frac{1}{2} \sum_p \left(
(\pm 1) a_{p\pm}^\dagger a_{p\mp} - (\mp 1)
a_{p\pm}^\dagger a_{p\mp} \right) =
%
\pm \frac{1}{2} \sum_p \left(
a_{p\pm}^\dagger a_{p\mp} + (\pm 1)
a_{p\pm}^\dagger a_{p\mp} \right) \\
%
&= \pm \sum_p a_{p\pm}^\dagger a_{p\mp} = \pm J_\pm,
\end{align*}
%
hvor siste liket følger av å sammenligne med ligning \eqref{eq:Jpm}. Jeg går så videre til neste kommutatorrelasjon jeg skal vise (bruker nå ligning \eqref{eq:Jpm} og fortsetter på samme måte som over):
\begin{align*}
[J_+,J_-] &= J_+ J_- - J_- J_+ \\
%
&= \left( \sum_p a_{p'+}^\dagger a_{p-} \right)
\left( \sum_{p'} a_{p'-}^\dagger a_{p'+} \right) -
\left( \sum_{p'} a_{p'-}^\dagger a_{p'+} \right)
\left( \sum_p a_{p+}^\dagger a_{p-} \right) \\
%
&= \sum_{p,p'} \left(
a_{p'+}^\dagger a_{p-} a_{p'-}^\dagger a_{p'+} -
a_{p'-}^\dagger a_{p'+} a_{p+}^\dagger a_{p-} \right) \\
%
&= \sum_{p,p'} \left(
a_{p'+}^\dagger a_{p-} a_{p'-}^\dagger a_{p'+} -
a_{p'-}^\dagger \left( \delta_{++} \delta_{pp'} -
a_{p+}^\dagger a_{p'+} \right) a_{p-} \right) \\
%
&= \sum_{p,p'} \left(
a_{p'+}^\dagger a_{p-} a_{p'-}^\dagger a_{p'+} -
a_{p'-}^\dagger \delta_{pp'} a_{p-} +
a_{p'-}^\dagger a_{p+}^\dagger a_{p'+} a_{p-} \right) \\
%
&= \sum_{p,p'} \left(
a_{p'+}^\dagger a_{p-} a_{p'-}^\dagger a_{p'+} -
a_{p'-}^\dagger \delta_{pp'} a_{p-} +
a_{p+}^\dagger a_{p'-}^\dagger a_{p-} a_{p'+} \right) \\
%
&= \sum_{p,p'} \left(
a_{p'+}^\dagger a_{p-} a_{p'-}^\dagger a_{p'+} -
a_{p'-}^\dagger \delta_{pp'} a_{p-} +
a_{p+}^\dagger \left( \delta_{--} \delta_{pp'} -
a_{p-} a_{p'-}^\dagger \right) a_{p'+} \right) \\
%
&= \sum_{p,p'} \left(
a_{p+}^\dagger \delta_{pp'} a_{p'+} -
a_{p'-}^\dagger \delta_{pp'} a_{p-} \right), \\
\end{align*}
%
hvor den siste likheten igjen kommer fra at jeg har fått permutert det siste opprinnelige leddet i summen til å bli det første ved hjelp av antikommutatorrelasjonene, men med en rest som sitter igjen. Siden deltafunksjonen igjen tar knekken på summen, sitter jeg igjen med:
%
\[ [J_+,J_-] = \sum_p \left(
a_{p+}^\dagger a_{p+} -
a_{p-}^\dagger a_{p-} \right) = 
%
2J_z, \]
%
hvor den siste likheten følger fra å sammenligne uttrykket over med ligning \eqref{eq:Jz}. Så videre til neste kommutatorrelasjon. Istedenfor å benytte ligning \eqref{eq:Jpm} og \eqref{eq:Jz} kan jeg nå benytte resultatene jeg har fått hittil til i tillegg til ligning \eqref{eq:J2} for å beregne resten av kommutatorene. Jeg får da
\[ [J^2, J_\pm] = [J_+ J_- + J_z^2 - J_z, J_\pm] =
[J_+ J_-, J_\pm] + [J_z^2, J_\pm] - [J_z, J_\pm]. \]
%
Jeg benytter så den øverste av de følgende to kommutatoridentitetene:
\begin{align}
[AB,C] &= A[B,C] + [A,C]B, \label{eq:ab,c} \\
[A,BC] &= [A,B]C + B[A,C], \label{eq:a,bc}
\end{align}
til å gå videre. Da får jeg
\[ [J^2, J_\pm] =
J_+ [J_-,J_\pm] + [J_+,J_\pm] J_- + J_z [J_z,J_\pm] + [J_z,J_\pm] J_z - [J_z,J_\pm]. \]
%
Jeg ser så på de to første kommutatorene på høyre hånd av likhetstegnet. Dersom det er $J_+$ som blir valgt i utgangspunktet får jeg for den første kommutatoren $[J_-, J_+] = -2J_z$ (fra et tidligere resultat), mens den andre kommutatoren blir $[J_+, J_+] = 0$. Dersom det er $J_-$ som er valgt i utgangspunktet blir den første kommutatoren $[J_-,J_-] = 0$, mens den andre kommutatoren blir $[J_+,J_-] = 2J_z$. Dette gir
\begin{align*}
[J^2, J_+] &= -2J_+ J_z + J_z [J_z,J_+] + [J_z,J_+] J_z - [J_z,J_+] \\
%
&= -2J_+ J_z + J_z J_+ + J_+ J_z - J_+ \\
%
&= -2J_+ J_z + J_+ + J_+ J_z + J_+ J_z - J_+ = 0,
\end{align*}
%
og tilsvarende
%
\begin{align*}
[J^2, J_-] &= 2J_z J_- + J_z [J_z,J_-] + [J_z,J_-] J_z - [J_z,J_-] \\
%
&= 2J_z J_- - J_z J_- - J_- J_z + J_- \\
%
&= J_z J_- - (J_z J_- + J_-) + J_- = 0.
\end{align*}
%
Til slutt regner jeg ut den siste kommutatoren på samme måte som den siste:
\begin{align*}
[J^2,J_z] &= [J_+ J_- + J_z^2 - J_z, J_z] \\
%
&= [J_+ J_-, J_z] + [J_z^2, J_z] - [J_z, J_z] \\
%
&= J_+ [J_-, J_z] + [J_+,J_z] J_- \\
%
&= J_+ J_- - J_+ J_- = 0
\end{align*}
%
Oppsummert kan jeg derfor skrive
\begin{align}
[J_z, J_\pm] &= \pm J_\pm, \label{eq:kJzJpm} \\
[J_+, J_-] &= 2J_z, \label{eq:kJpJm} \\
[J^2, J_\pm] &= 0, \label{eq:kJ2Jpm} \\
[J^2,J_z] &= 0, \label{eq:kJ2Jz}
\end{align}
som er nøyaktig de samme kommutatorrelasjonene som man har for angulært moment $L_\pm$, $L_z$ og $L^2$.


\section{Hamiltonoperatoren}

Hamiltonoperatoren til dette systemet er oppgitt til å være
\begin{align}
H &= H_0 + H_1 +H_2,
\label{eq:H} \\
%
H_0 &= \frac{1}{2} \varepsilon \sum_{p\sigma}
\sigma a_{p\sigma}^{\dagger}a_{p\sigma},
\label{eq:H0} \\
%
H_1 &= \frac{1}{2} V \sum_{p,p',\sigma}
a_{p\sigma}^\dagger a_{p'\sigma}^\dagger a_{p'-\sigma} a_{p-\sigma},
\label{eq:H1} \\
%
H_{2} &= \frac{1}{2} W \sum_{p,p',\sigma}
a_{p\sigma}^\dagger a_{p'-\sigma}^\dagger a_{p'\sigma}a_{p-\sigma}.
\label{eq:H2}
\end{align}
%
Jeg skal nå uttrykke denne ved hjelp av kvasispinnoperatorene gitt ved ligning \eqref{eq:Jpm} til \eqref{eq:J2} og antallsoperatoren
\begin{equation}
N = \sum_{p,\sigma} a_{p\sigma}^\dagger a_{p\sigma}.
\label{eq:N}
\end{equation}
%
Jeg tar nå hvert ledd av $H$ for seg, og først tar jeg $H_0$ gitt ved ligning \eqref{eq:H0}. Ved å sammenligne denne ligningen med ligning \eqref{eq:Jz} for $J_z$, ser jeg at de er nøyaktig like, sett bort fra en faktor $\varepsilon$. Altså må jeg ha
\begin{equation}
H_0 = \varepsilon J_z.
\label{eq:H0ny}
\end{equation}
%
Så videre til $H_1$ gitt ved ligning \eqref{eq:H1}. Jeg benytter antikommutasjonsreglene \eqref{eq:al,ak} til \eqref{eq:ald,ak} for å stokke om på kreasjon og annihilasjonsoperatorene. Det gir:
\begin{align*}
H_1 &= \frac{1}{2} V \sum_{p,p',\sigma}
a_{p\sigma}^\dagger a_{p'\sigma}^\dagger a_{p'-\sigma} a_{p-\sigma} \\
%
&= \frac{1}{2} V \sum_{p,p',\sigma}
-a_{p\sigma}^\dagger a_{p'\sigma}^\dagger a_{p-\sigma} a_{p'-\sigma} \\
%
&= \frac{1}{2} V \sum_{p,p',\sigma}
-a_{p\sigma}^\dagger \left( \delta_{pp'} \delta_{\sigma -\sigma} - a_{p-\sigma} a_{p'\sigma}^\dagger \right) a_{p'-\sigma} \\
%
&= \frac{1}{2} V \sum_{p,p',\sigma}
a_{p\sigma}^\dagger a_{p-\sigma} a_{p'\sigma}^\dagger a_{p'-\sigma} \\
\end{align*}
%
Jeg løser så opp summen over $\sigma$. Det gir
\begin{align*}
H_1 &= \frac{1}{2} V\sum_{p,p'}
a_{p+}^\dagger a_{p-} a_{p'+}^\dagger a_{p'-} +
a_{p-}^\dagger a_{p+} a_{p'-}^\dagger a_{p'+} \\
%
&= \frac{1}{2} V \left[ \sum_p \left( a_{p+}^\dagger a_{p-} \right)
\sum_{p'} \left( a_{p'+}^\dagger a_{p'-} \right) +
\sum_p \left( a_{p-}^\dagger a_{p+} \right)
\sum_{p'} \left( a_{p'-}^\dagger a_{p'+} \right) \right] \\
%
&= \frac{1}{2} V \left[ J_+ J_+ + J_- J_- \right] = \frac{1}{2} V \left[ J_+^2 + J_-^2 \right] ,
\end{align*}
hvor overgangen fra nest siste til siste linje skjer ved å sammenligne uttrykkene med uttrykket for $J_\pm$ i ligning \eqref{eq:Jpm}. Da får jeg
\begin{equation}
H_1 = \frac{1}{2} V \left( J_+^2 + J_-^2 \right).
\label{eq:H1ny}
\end{equation}
%
Til slutt ser jeg på leddet $H_2$ gitt ved ligning \eqref{eq:H2}. Jeg benytter samme fremgangsmåte som over, altså å bytte om på kreasjons- og annihilasjonsoperatorer ved hjelp av antikommutasjonsrelasjonene. Det gir
\begin{align*}
H_2 &= \frac{1}{2} W \sum_{p,p',\sigma}
a_{p\sigma}^\dagger a_{p'-\sigma}^\dagger a_{p'\sigma} a_{p-\sigma} \\
%
&= \frac{1}{2} W \sum_{p,p',\sigma}
-a_{p\sigma}^\dagger a_{p'-\sigma}^\dagger a_{p-\sigma} a_{p'\sigma} \\
%
&= \frac{1}{2} W \sum_{p,p',\sigma}
-a_{p\sigma}^\dagger \left( \delta_{pp'} \delta_{-\sigma -\sigma} -
a_{p-\sigma} a_{p'-\sigma}^\dagger \right) a_{p'\sigma} \\
%
&= \frac{1}{2} W \sum_{p,p',\sigma}
-a_{p\sigma}^\dagger \delta_{pp'} a_{p'\sigma} +
a_{p\sigma}^\dagger a_{p-\sigma} a_{p'-\sigma}^\dagger a_{p'\sigma} \\
%
&= \frac{1}{2} W \left( -\sum_{p,\sigma}
a_{p\sigma}^\dagger a_{p\sigma} +
\sum_{p,p',\sigma} a_{p\sigma}^\dagger a_{p-\sigma} a_{p'-\sigma}^\dagger a_{p'\sigma} \right) \\
\end{align*}
%
Som i sted ser jeg på hvert av leddene for seg. Den første summen ser jeg ved å sammenligne med ligning \eqref{eq:N} for antallsoperatoren $N$ at nettopp blir $N$. I den andre summen løser jeg opp summasjonen over $\sigma$ og ser hva som skjer:
\begin{align*}
\sum_{p,p',\sigma} a_{p\sigma}^\dagger a_{p-\sigma} a_{p'-\sigma}^\dagger a_{p'\sigma}
%
&= \sum_{p,p'} a_{p+}^\dagger a_{p-} a_{p'-}^\dagger a_{p'+} +
a_{p-}^\dagger a_{p+} a_{p'+}^\dagger a_{p'-} \\
%
&= \sum_p \left( a_{p+}^\dagger a_{p-} \right)
\sum_{p'} \left( a_{p'-}^\dagger a_{p'+} \right) +
\sum_p \left( a_{p-}^\dagger a_{p+} \right)
\sum_{p'} \left( a_{p'+}^\dagger a_{p'-} \right) \\
%
&= J_+ J_- + J_- J_+,
\end{align*}
%
hvor den siste likheten fremkommer på samme måte som i sted. Innsatt i uttrykket for $H_2$ gir dette
\begin{equation}
H_2 = \frac{1}{2} W \left( -N + J_+ J_- + J_- J_+ \right).
\label{eq:H2ny}
\end{equation}
Altså er Hamiltonoperatoren $H$ uttrykt ved hjelp av kvasispinnoperatorene og antallsoperatoren gitt ved ligning \eqref{eq:H}, \eqref{eq:H0ny}, \eqref{eq:H1ny} og \eqref{eq:H2ny}.


\section{Kommutatoren $[H,J^2]$}

Jeg skal nå vise at $[H,J^2] = 0$, noe som betyr at $J$ er et godt kvantetall. Jeg setter da inn uttrykkene jeg fant for $H$ i forrige oppgave gitt ved ligning \eqref{eq:H}, \eqref{eq:H0ny}, \eqref{eq:H1ny} og \eqref{eq:H2ny}, samt uttrykket for $J^2$ gitt ved ligning \eqref{eq:J2}, og regner ut:
%
\begin{align*}
[H,J^2] &= [H_0 + H_1 + H_2,J^2] \\
%
&= [H_0,J^2] + [H_1,J^2] + [H_2,J^2] \\
%
&= \varepsilon [J_z,J^2] + \frac{1}{2} V [J_+^2 + J_-^2,J^2] +
\frac{1}{2} W [-N + J_+ J_- + J_- J_+,J^2]. \\
\end{align*}
%
Ved så å bruke kommutasjonsreglen jeg har funnet tidligere gitt i ligning\eqref{eq:kJ2Jz} gir dette
%
\[ [H,J^2] = \frac{1}{2} V \left( [J_+^2,J^2] + [J_-^2,J^2] \right) +
\frac{1}{2} W \left( -[N,J^2] + [J_+ J_-,J^2] + [J_- J_+, J^2] \right) \]
%
Siden $[J_\pm,J^2] = 0$, må $[J_\pm^2,J^2] = 0$ (dette kan enkelt sees ved å benytte identiteten for operatorer gitt ved ligning \eqref{eq:ab,c}). Denne identiteten gir da på samme måte at både $[J_+ J_-,J^2] = 0$ og $[J_- J_+, J^2] = 0$. Jeg sitter dermed igjen med kommutatoren $[N,J^2]$ som jeg foreløpig ikke vet hva er. Denne kan jeg derimot regne ut. Først setter jeg inn for $J^2$ ved hjelp av ligning \eqref{eq:J2} og benytter identiteten gitt ved ligning \eqref{eq:a,bc}:
%
\begin{align*}
[H,J^2] &= -\frac{1}{2} W [N,J^2] \\
%
&= \frac{1}{2} W \left( -[N,J_+ J_-] - [N,J_z^2] + [N,J_z] \right) \\
&= \frac{1}{2} W \left( -[N,J_+]J_- - J_+[N,J_-] - [N,J_z]J_z - J_z[N,J_z] + [N,J_z] \right).
\end{align*}
%
Jeg må så finne kommutatorene som inngår i uttrykket over. Det gjør jeg ved å sette inn uttrykkene for $J_\pm$ gitt ved ligning \eqref{eq:Jpm} og for $N$ gitt ved ligning \eqref{eq:N} inn i kommutatorene og regne ut på samme måte som før. Det gir:
%
\begin{align*}
[N,J_\pm] &= N J_\pm - J_\pm N \\
%
&= \left( \sum_{p,\sigma} a_{p\sigma}^\dagger a_{p\sigma} \right)
\left( \sum_{p'} a_{p'\pm}^\dagger a_{p'\mp} \right) -
\left( \sum_{p'} a_{p'\pm}^\dagger a_{p'\mp} \right)
\left( \sum_{p,\sigma} a_{p\sigma}^\dagger a_{p\sigma} \right) \\
%
&= \sum_{p,p',\sigma}
a_{p\sigma}^\dagger a_{p\sigma} a_{p'\pm}^\dagger a_{p'\mp} -
a_{p'\pm}^\dagger a_{p'\mp} a_{p\sigma}^\dagger a_{p\sigma} \\
%
&= \sum_{p,p',\sigma}
a_{p\sigma}^\dagger a_{p\sigma} a_{p'\pm}^\dagger a_{p'\mp} -
a_{p'\pm}^\dagger \left( \delta_{\mp \sigma} \delta_{pp'} - a_{p\sigma}^\dagger a_{p'\mp} \right) a_{p\sigma} \\
%
&= \sum_{p,p',\sigma}
a_{p\sigma}^\dagger a_{p\sigma} a_{p'\pm}^\dagger a_{p'\mp} -
a_{p'\pm}^\dagger \delta_{\mp \sigma} \delta_{pp'} a_{p\sigma} +
a_{p'\pm}^\dagger a_{p\sigma}^\dagger a_{p'\mp} a_{p\sigma} \\
%
&= \sum_{p,p',\sigma}
a_{p\sigma}^\dagger a_{p\sigma} a_{p'\pm}^\dagger a_{p'\mp} +
a_{p\sigma}^\dagger a_{p'\pm}^\dagger a_{p\sigma} a_{p'\mp} -
\sum_{p} a_{p\pm}^\dagger  a_{p\mp} \\
%
&= \sum_{p,p',\sigma}
a_{p\sigma}^\dagger a_{p\sigma} a_{p'\pm}^\dagger a_{p'\mp} +
a_{p\sigma}^\dagger \left( \delta_{pp'} \delta_{\pm \sigma} -
a_{p\sigma} a_{p'\pm}^\dagger \right) a_{p'\mp} -
\sum_{p} a_{p\pm}^\dagger  a_{p\mp} \\
%
&= \sum_p a_{p\pm}^\dagger a_{p\mp} -
\sum_{p} a_{p\pm}^\dagger  a_{p\mp} = 0. \\
\end{align*}
%
Så den andre kommutatoren som jeg regner ut på tilsvarende måte, men jeg setter nå inn for $J_z$ gitt ved ligning \eqref{eq:Jz}:
\begin{align*}
[N,J_z] &= N J_z - J_z N \\
%
&= \left( \sum_{p,\sigma} a_{p\sigma}^\dagger a_{p\sigma} \right)
\left( \frac{1}{2}\sum_{p',\sigma} \sigma a_{p'\sigma}^\dagger a_{p'\sigma} \right) -
\left( \frac{1}{2}\sum_{p',\sigma} \sigma a_{p'\sigma}^\dagger a_{p'\sigma} \right)
\left( \sum_{p,\sigma} a_{p\sigma}^\dagger a_{p\sigma} \right) \\
%
&= \sum_{p,p',\sigma} 
\sigma a_{p\sigma}^\dagger a_{p\sigma} a_{p'\sigma}^\dagger a_{p'\sigma} -
\sigma a_{p'\sigma}^\dagger a_{p'\sigma} a_{p\sigma}^\dagger a_{p\sigma} = 0
\end{align*}
%
Her kan jeg se at kommutatoren blir $0$ med en gang fordi summasjonen over $p$ og $p'$ er helt symmetrisk. Eventuelt innse at det siste leddet kan trekkes ut som en egen sum der jeg kan bytte om navnene på $p$ og $p'$.

Siden alle delkommutatorene i uttrykket for $[H,J^2]$ nå har vist seg å være $0$, har jeg følgelig
\begin{equation}
[H,J^2] = 0,
\label{eq:kHJ2}
\end{equation}
og $J$ er dermed et godt kvantetall.


\section{Mulige tilstander med $J = 2$}

Jeg får nå oppgitt at tilstanden
\begin{equation}
\ket{2,-2} = a_{1-}^{\dagger} a_{2-}^{\dagger}
a_{3-}^{\dagger} a_{4-}^{\dagger} \ket{0}
\label{eq:2,-2}
\end{equation}
som har $J_z = -2$ og $J = 2$ (tilstandene skrives på formen $\ket{J,J_z}$). Jeg får så oppgitt at de andre mulige tilstandene med $J = 2$ er de med $J_z = -1,0,1,2$. I tillegg har jeg følgende relasjoner:
\begin{align}
J_+ \ket{J,J_z} &= \sqrt{J(J+1) - J_z(J_z + 1)} \ket{J,J_z + 1},
\label{eq:J+ket} \\
J_- \ket{J,J_z} &= \sqrt{J(J+1) - J_z(J_z - 1)} \ket{J,J_z - 1}.
\label{eq:J-ket}
\end{align}
%
Jeg kan dermed konstruere de andre tilstandene med $J = 2$ ved å anvende stigeoperatoren $J_+$ på $\ket{2,-2}$:
\[ J_+ \ket{2,-2} = \sqrt{2(2+1) - (-2)(-2+1)} \ket{2,-2+1} =
\sqrt{6 - 2} \ket{2,-1} = 2\ket{2,-1}, \]
som gir ved innsetting av ligning \eqref{eq:Jpm} for $J_+$ og ligning \eqref{eq:2,-2} for $\ket{2,-2}$:
\begin{align}
\ket{2,-1} &= \frac{1}{2} J_+ \ket{2,-2} \notag \\
%
&= \frac{1}{2} \sum_p a_{p+}^\dagger a_{p-} a_{1-}^{\dagger} a_{2-}^{\dagger}
a_{3-}^{\dagger} a_{4-}^{\dagger} \ket{0} \notag \\
%
&= \frac{1}{2} \left(
a_{1+}^{\dagger} a_{2-}^{\dagger} a_{3-}^{\dagger} a_{4-}^{\dagger} +
a_{1-}^{\dagger} a_{2+}^{\dagger} a_{3-}^{\dagger} a_{4-}^{\dagger} +
a_{1-}^{\dagger} a_{2-}^{\dagger} a_{3+}^{\dagger} a_{4-}^{\dagger} +
a_{1-}^{\dagger} a_{2-}^{\dagger} a_{3-}^{\dagger} a_{4+}^{\dagger}
\right) \ket{0}. \label{eq:2,-1}
\end{align}
%
Her følger den siste likheten fra hvordan summen virker. Det andre leddet oppstår for eksempel som en konsekvens av andre ledd i summen i nest siste linje (da er $p = 2$). Da vil $a_{2-}$ først destruere virkningen av $a_{2-}^\dagger$, men så vil $a_{2-}^\dagger$ gjenopprette den. I tillegg er det gjort to permuteringer som gir et fortegn på $(-1)^2 = 1$. Det blir alltid gjort et partall permuteringer for å flytte på operatorene, slik at fortegnet blir positivt på alle ledd.

Jeg kan nå videre regne ut $\ket{2,0}$ på samme måte:
\[ J_+ \ket{2,-1} = \sqrt{2(2+1) - (-1)(-1+1)} \ket{2,-1+1} = \sqrt{6} \ket{2,0}, \]
som gir ved å sette inn for $\ket{2,-1}$ fra ligning \eqref{eq:2,-1} og for $J_+$ fra ligning \eqref{eq:Jpm}:
\begin{align*}
\ket{2,0} &= \frac{1}{\sqrt{6}} J_+ \ket{2,-1} \\
%
&= \frac{1}{2\sqrt{6}} \sum_p a_{p+}^\dagger a_{p-} \left(
a_{1+}^{\dagger} a_{2-}^{\dagger} a_{3-}^{\dagger} a_{4-}^{\dagger} +
a_{1-}^{\dagger} a_{2+}^{\dagger} a_{3-}^{\dagger} a_{4-}^{\dagger} + \right. \\
&\quad\,\, \left.
a_{1-}^{\dagger} a_{2-}^{\dagger} a_{3+}^{\dagger} a_{4-}^{\dagger} +
a_{1-}^{\dagger} a_{2-}^{\dagger} a_{3-}^{\dagger} a_{4+}^{\dagger}
\right) \ket{0}
\end{align*}
%
For å se hva dette blir tenker jeg på samme måte som over. For en gitt $p$, vil virkningen av $a_{p+}^\dagger a_{p-}$ være å flytte partikkelen opp fra $\sigma = -1$ til $\sigma = +1$, og det vil ikke bli noe fortegnsskifte, da man hele tiden må gjøre et partall antall permutasjoner blant $a_{1+}^{\dagger} a_{2-}^{\dagger} a_{3-}^{\dagger} a_{4-}^{\dagger}$ og de andre leddene. Dersom tilstanden $(p,\sigma = -1)$ derimot er ledig vil $a_{p-}$ medføre at leddet blir $0$. I tillegg vil alle ledd komme to ganger fordi kombinasjonen $a_{p+} a_{p'+}$ vil fremkomme på to forskjellige måter:
\[ \left( a_{p'+}^\dagger a_{p'-} \right) a_{p+}^\dagger a_{p'-}^\dagger = a_{p+}^\dagger a_{p'+}^\dagger, \quad
\left( a_{p+}^\dagger a_{p-} \right) a_{p-}^\dagger a_{p'+}^\dagger = a_{p+}^\dagger a_{p'+}^\dagger. \]
%
Dette gir at jeg har
\begin{equation}
\begin{aligned}
\ket{2,0} &= \frac{1}{\sqrt{6}} \left(
a_{1+}^{\dagger} a_{2+}^{\dagger} a_{3-}^{\dagger} a_{4-}^{\dagger} +
a_{1+}^{\dagger} a_{2-}^{\dagger} a_{3+}^{\dagger} a_{4-}^{\dagger} +
a_{1+}^{\dagger} a_{2-}^{\dagger} a_{3-}^{\dagger} a_{4+}^{\dagger} +
a_{1-}^{\dagger} a_{2+}^{\dagger} a_{3+}^{\dagger} a_{4-}^{\dagger} + \right. \\
&\quad\,\, \left.
a_{1-}^{\dagger} a_{2+}^{\dagger} a_{3-}^{\dagger} a_{4+}^{\dagger} +
a_{1-}^{\dagger} a_{2-}^{\dagger} a_{3+}^{\dagger} a_{4+}^{\dagger} \right) \ket{0}
\end{aligned}
\label{eq:2,0}
\end{equation}
%
Så finner jeg $\ket{2,1}$, igjen på samme måte:
\[ J_+ \ket{2,0} = \sqrt{2(2+1) - 0(0+1)} \ket{2,0+1} = \sqrt{6}\ket{2,1}, \]
som gir
%
\begin{align*}
\ket{2,1} &= \frac{1}{\sqrt{6}} J_+ \ket{2,0} \\
%
&= \frac{1}{6} \sum_p a_{p+}^\dagger a_{p-}
\left(
a_{1+}^{\dagger} a_{2+}^{\dagger} a_{3-}^{\dagger} a_{4-}^{\dagger} +
a_{1+}^{\dagger} a_{2-}^{\dagger} a_{3+}^{\dagger} a_{4-}^{\dagger} +
a_{1+}^{\dagger} a_{2-}^{\dagger} a_{3-}^{\dagger} a_{4+}^{\dagger} +
a_{1-}^{\dagger} a_{2+}^{\dagger} a_{3+}^{\dagger} a_{4-}^{\dagger} + \right. \\
&\quad\,\, \left.
a_{1-}^{\dagger} a_{2+}^{\dagger} a_{3-}^{\dagger} a_{4+}^{\dagger} +
a_{1-}^{\dagger} a_{2-}^{\dagger} a_{3+}^{\dagger} a_{4+}^{\dagger} \right) \\
\end{align*}
%
Nå ser jeg at hvert enkelt ledd i den ferdige summen vil komme ikke $2$, men $3$ ganger. Dette fordi kombinasjonen $a_{p+} a_{p'+} a_{p''+}$ vil fremkomme på tre forskjellige måter:
\begin{align*}
\left( a_{p''+}^\dagger a_{p''-} \right) a_{p+}^{\dagger} a_{p'+}^{\dagger} a_{p''-}^{\dagger}
&= a_{p+}^{\dagger} a_{p'+}^{\dagger} a_{p''+}^{\dagger} \\
%
\left( a_{p'+}^\dagger a_{p'-} \right) a_{p+}^{\dagger} a_{p'-}^{\dagger} a_{p''+}^{\dagger}
&= a_{p+}^{\dagger} a_{p'+}^{\dagger} a_{p''+}^{\dagger} \\
%
\left( a_{p+}^\dagger a_{p-} \right) a_{p-}^{\dagger} a_{p'+}^{\dagger} a_{p''-}^{\dagger}
&= a_{p+}^{\dagger} a_{p'+}^{\dagger} a_{p''+}^{\dagger}.
\end{align*}
%
Samtidig gir ledd som får $a_{p-}$ men som ikke har $a_{p+}^\dagger$ lenger til høyre i leddet bli $0$ på samme måte som i sted. Dette betyr at jeg får
%
\begin{equation}
\ket{2,1} = \frac{1}{2} \left(
a_{1+}^{\dagger} a_{2+}^{\dagger} a_{3+}^{\dagger} a_{4-}^{\dagger} +
a_{1+}^{\dagger} a_{2+}^{\dagger} a_{3-}^{\dagger} a_{4+}^{\dagger} +
a_{1+}^{\dagger} a_{2-}^{\dagger} a_{3+}^{\dagger} a_{4+}^{\dagger} +
a_{1-}^{\dagger} a_{2+}^{\dagger} a_{3+}^{\dagger} a_{4+}^{\dagger}
 \right).
\label{eq:2,1}
\end{equation}
%
Så videre til tilstanden $\ket{2,2}$. Igjen finner jeg normeringsfaktoren:
\[ J_+ \ket{2,1} = \sqrt{2(2+1) - 1(1+1)} \ket{2,1+1} = \sqrt{4} \ket{2,2} = 2\ket{2,2} . \]
%
Dermed kan jeg nå finne den siste tilstanden:
\begin{align*}
\ket{2,2} &= \frac{1}{2} J_+ \ket{2,1} \\
%
&= \frac{1}{4} \sum_p a_{p+}^\dagger a_{p-} \left(
a_{1+}^{\dagger} a_{2+}^{\dagger} a_{3+}^{\dagger} a_{4-}^{\dagger} +
a_{1+}^{\dagger} a_{2+}^{\dagger} a_{3-}^{\dagger} a_{4+}^{\dagger} +
a_{1+}^{\dagger} a_{2-}^{\dagger} a_{3+}^{\dagger} a_{4+}^{\dagger} +
a_{1-}^{\dagger} a_{2+}^{\dagger} a_{3+}^{\dagger} a_{4+}^{\dagger}
\right)
\end{align*}
%
Her bruker jeg igjen samme argumentasjon som tidligere, men jeg gidder ikke å forklare ting like nøye denne gangen også. Det som skjer er at $J_+$ vil i hvert ledd gjøre om leddet med $\sigma = -1$ til $\sigma = +1$. Det gjør at jeg får totalt fire identiske ledd som blir $a_{1+}^{\dagger} a_{2+}^{\dagger} a_{3+}^{\dagger} a_{4+}^{\dagger}$, og dermed har jeg
\begin{equation}
\ket{2,2} = a_{1+}^{\dagger} a_{2+}^{\dagger} a_{3+}^{\dagger} a_{4+}^{\dagger} \ket{0}.
\label{eq:2,2}
\end{equation}
%
Dermed har jeg funnet alle de andre tilstandene med $J = 2$, og de er gitt ved ligning \eqref{eq:2,-1} til \eqref{eq:2,2} over.


\section{Hamiltonmatrisa i underrommet $J = 2$}

Jeg skal nå finne Hamiltonmatrisa i underrommet $J = 2$, det vil si alle elementene $\bra{2,J_z} H \ket{2,J_z'}$. De fem tilstandene dette rommet inneholder fant jeg i forrige oppgave, mens Hamiltonmatrisa uttrykt ved kvasispinnoperatorene er gitt ved ligning \eqref{eq:H0} og \eqref{eq:H0ny} til \eqref{eq:H2ny}. Jeg setter inn og regner ut:
\begin{align*}
\bra{2,J_z} H \ket{2,J_z'}
%
&= \bra{2,J_z} H_0 \ket{2,J_z'} + \bra{2,J_z} H_1 \ket{2,J_z'} +
\bra{2,J_z} H_2 \ket{2,J_z'} \\
%
&= \varepsilon  \bra{2,J_z} J_z \ket{2,J_z'} +
\frac{1}{2} V  \bra{2,J_z} \left( J_+^2 + J_-^2 \right) \ket{2,J_z'} + \\
&\quad\,\,
\frac{1}{2} W \bra{2,J_z} \left( -N + J_+ J_- + J_- J_+ \right) \ket{2,J_z'} \\
\end{align*}
%
Siden tilstandene $\ket{J,J_z}$ er egenfunksjoner for hermittiske operatorer vil de være ortonormale, og jeg har dermed $\braket{J,J_z}{J,J_z'} = \delta_{J_z J_z'}$. Jeg bruker også ligning \eqref{eq:J+ket} og \eqref{eq:J-ket} til å gå videre. Vær klar over at $J_z$ står nå både for operatoren og kvantetallet, men for å unngå forvirring under sier jeg at når $J_z$ står innenfor en braket er den en operator, og utenfor er den kvantetallet. Jeg får da 
\begin{align*}
\bra{2,J_z} H \ket{2,J_z'}
%
&= \varepsilon  J_z' \braket{2,J_z}{2,J_z'} +
\frac{1}{2} V  \left( \bra{2,J_z} J_+^2 \ket{2,J_z'} + \bra{2,J_z} J_-^2 \ket{2,J_z'}  \right) + \\
&\quad\,\,
\frac{1}{2} W \left( -\bra{2,J_z}N \ket{2,J_z'} + \bra{2,J_z}J_+ J_- \ket{2,J_z'} + \bra{2,J_z} J_- J_+ \ket{2,J_z'} \right)  \\
%
&= \varepsilon  J_z' \delta{J_z J_z'} + \frac{1}{2} V \left(
\sqrt{6-J_z'(J_z'+1)} \sqrt{6-(J_z'+1)(J_z'+2)} \braket{2,J_z}{2,J_z'+2} + \right. \\
&\quad\,\, \left.
\sqrt{6-J_z'(J_z'-1)} \sqrt{6-(J_z'-1)(J_z'-2)} \braket{2,J_z}{2,J_z'-2} \right) + \\
&\quad\,\,
\frac{1}{2} W \left( - 4 +
\sqrt{6-J_z'(J_z'-1)} \sqrt{6-(J_z'-1)J_z'} \braket{2,J_z}{2,J_z'} + \right. \\
&\quad\,\, \left.
\sqrt{6-J_z'(J_z+1)} \sqrt{6-(J_z'+1)J_z} \braket{2,J_z}{2,J_z'}
\right) \\
%
&= \varepsilon  J_z' \delta_{J_z J_z'} + \frac{1}{2} V \left(
\sqrt{6-J_z'(J_z'+1)} \sqrt{6-(J_z'+1)(J_z'+2)} \delta_{J_z J_z'+2} + \right. \\
&\quad\,\, \left.
\sqrt{6-J_z'(J_z'-1)} \sqrt{6-(J_z'-1)(J_z'-2)} \delta_{J_z J_z'-2} \right) + \\
&\quad\,\,
\frac{1}{2} W \left( - 4 +
\sqrt{6-J_z'(J_z'-1)} \sqrt{6-(J_z'-1)J_z'} \delta_{J_z J_z'} + \right. \\
&\quad\,\, \left.
\sqrt{6-J_z'(J_z+1)} \sqrt{6-(J_z'+1)J_z} \delta_{J_z J_z'}
\right). \\
\end{align*}
%
Jeg setter så $J_z, J_z' = -2,-1,0,1,2$ inn i ligningen over, og får da:
\begin{align*}
\bra{2,-2} H \ket{2,-2} &= -2\varepsilon +
\frac{1}{2} W \left( -4 + \sqrt{6-(-2)(-2-1)} \sqrt{6-(-2-1)(-2)} + \right. \\
&\quad\,\, \left.
\sqrt{6-(-2)(-2+1)} \sqrt{6-(-2+1)(-2)} \right) \\
%
&= -2\varepsilon + \frac{1}{2} W \left( -4 + 4 \right) = -2\varepsilon,
\end{align*}
%
\[ \bra{2,-1} H \ket{2,-1} =
-\varepsilon + \frac{1}{2} W \left( -4 + 4 + 6 \right) = -\varepsilon + 3W, \]
%
\[ \bra{2,0} H \ket{2,0} = \frac{1}{2} W \left( -4 + 6 + 6 \right) = 4W, \]
%
\[ \bra{2,1} H \ket{2,1} = \varepsilon + \frac{1}{2} W \left( -4 + 6 + 4 \right) = \varepsilon + 3W, \]
%
\[ \bra{2,2} H \ket{2,2} = 2\varepsilon + \frac{1}{2} W \left( -4 + 4 \right) = 2\varepsilon. \]
%
Dette var altså alle diagonalelementene. Går så videre til de ikke-diagonale elementene. Ser at på grunn av deltafunksjonene vil alle ledd der $J_z - J_z' = \pm 1$ falle bort. Altså har jeg:
\[ \bra{2,-2} H \ket{2,-1} = 0, \quad \bra{2,-1} H \ket{2,-0} = 0, \quad \bra{2,0} H \ket{2,1} = 0, \quad \bra{2,1} H \ket{2,2} = 0. \]
På samme måte ser jeg at alle ledd der $J_z - J_z' = \pm 3$ også er 0, som gir
\[ \bra{2,-2} H \ket{2,1} = 0, \quad \bra{2,-1} H \ket{2,2} = 0. \]
Jeg må dermed se på de resterende leddene, altså leddene der $\delta_{J_z J_z'}$ faller bort, men ikke $\delta_{J_z J_z' \pm 2}$:
\[ \bra{2,-2} H \ket{2,0} =
\frac{1}{2} V \sqrt{6} \sqrt{4} = \sqrt{6}V, \]
%
\[ \bra{2,-1} H \ket{2,1} = \frac{1}{2} V \sqrt{6} \sqrt{6} = 3V, \]
%
\[ \bra{2,0} H \ket{2,2} = \frac{1}{2} V \sqrt{4} \sqrt{6} = \sqrt{6}V. \]
%
Siden Hamiltonmatrisen må være hermittisk, og $\epsilon$, $V$ og $W$ er reelle, vil Hamiltonmatrisen i dette tilfelle være symmetrisk. Altså kan jeg nå skrive opp hamiltonmatrisen:
\begin{equation}
H_{J = 2} =
\begin{pmatrix}
-2\varepsilon & 0 & \sqrt{6}V & 0 & 0 \\
0 & -\varepsilon + 3W & 0 & 3V & 0 \\
\sqrt{6}V & 0 & 4W & 0 & \sqrt{6}V \\
0 & 3V & 0 & \varepsilon + 3W & 0 \\
0 & 0 & \sqrt{6}V & 0 & 2\varepsilon
\end{pmatrix}
\label{eq:HJ=2}
\end{equation}
%
Jeg ser så på hva Hamitonmatrisa blir for visse verdier av $\varepsilon$, $V$ og $W$, og diagonaliserer den via Octave:
\begin{enumerate}
\item $\epsilon = 2$, $V = -1/3$, $W = -1/4$: Hamilton matrisa blir da:
\[ H_{J=2}^{(1)} =
\begin{pmatrix}
-4 & 0 & -\sqrt{6}/3 & 0 & 0 \\
0 & -2 - 3/4 & 0 & -1 & 0 \\
-\sqrt{6}/3 & 0 & -1 & 0 & -\sqrt{6}/3 \\
0 & -1 & 0 & 2 + -3/4 & 0 \\
0 & 0 & -\sqrt{6}/3 & 0 & 4
\end{pmatrix}, \]
som diagonaliseres til $PDP^{-1}$ hvor
\[ P = \begin{pmatrix}
0.96735 & 0 &  0.25294 &  0 & 0.01602 \\
0 &  0.97325 & 0 &  0.22975 & 0 \\
0.25221 & 0 & -0.95442 &  0 & -0.15959 \\
0 &  0.22975 & 0 & -0.97325 &  0 \\
0.02507 & 0 & -0.15842 &  0 & 0.98705
\end{pmatrix}, \]
og
\[ D = \begin{pmatrix}
-4.21288 &  0 &  0 &  0 &  0 \\
0 & -2.98607  & 0  & 0  & 0 \\
0 &  0 & -0.91914  & 0  & 0 \\
0 &  0 & 0   & 1.48607  & 0 \\
0 &  0  & 0  & 0  & 4.13201
\end{pmatrix}. \]
Grunntilstanden er tilstanden med laves energi, og er dermed tilstanden gitt ved den første kolonnen i $P$. Skrevet ut gir dette at grunntilstanden er
\[ \ket{\text{grunntilstand}} = 0.96735\ket{2,-2} + 0.25221\ket{2,0} + 0.02507\ket{2,2}, \]
og denne tilstanden har egenenergien $E_\text{gr} = -4.21288$.
%
\item $\varepsilon = 2$, $V = -4/3$, $W = -1$: Hamiltonmatrisa blir da:
\[ H_{J=2}^{(2)} =
\begin{pmatrix}
-4 & 0 & -4\sqrt{6}/3 & 0 & 0 \\
0 & -5 & 0 & -4 & 0 \\
-4\sqrt{6}/3 & 0 & -4 & 0 & -4\sqrt{6}/3 \\
0 & -4 & 0 & -1 & 0 \\
0 & 0 & -4\sqrt{6}/3 & 0 & 4
\end{pmatrix}, \]
som kan diagonaliseres i $PDP^{-1}$ der
\[ P = \begin{pmatrix}
-0.64268 &  0 & -0.75515 &  0 &  0.12929 \\
0 &  0.85065 &  0 &  0.52573 &  0 \\
-0.73816 &  0 &  0.56514 &  0 & -0.36843 \\
0 &  0.52573 &  0 & -0.85065 &  0 \\
-0.20515 &  0 &  0.33222 &  0 &  0.92062
\end{pmatrix}, \]
og
\[ D = \begin{pmatrix}
-7.75122 &  0 &  0 &  0  & 0 \\
0 & -7.47214  & 0  & 0  & 0 \\
0 &  0  & -1.55581 &  0  & 0 \\
0 &  0  & 0  & 1.47214  & 0 \\
0 &  0  & 0  & 0  & 5.30704
\end{pmatrix}. \]
Grunntilstanden blir nå gitt ved den første kolonnen i den nye $P$-matrisen:
\[ \ket{\text{grunntilstand}} = 0.64268\ket{2,-2} + 0.73816\ket{2,0} + 0.20515 \ket{2,2}, \]
og denne tilstanden har egenenergi $E_\text{gr} = -7.75122$.
\end{enumerate}
%
For tilfelle 1 er sannsynligheten for å observere systemet i tilstanden $\ket{2,-2}$ være stor dersom systemet blir preparert til å være i grunntilstanden. Det er ikke så rart fordi vekselvirkningen med de gitte parametrene er liten, og effekten av $H_0$ vil derfor dominere. Vekselvirkningsleddene $H_1$ og $H_2$ vil påvirke systemet litt slik at det vil være en viss sannsynlighet for å observere systemet i $\ket{2,0}$ eller $\ket{2,2}$. For tilfelle 2 derimot er effekten av vekselvirkningsleddene langt høyere, og sannsynlighetstettheten blir jevnet mer ut.

Når energien øker vil sannsynligheten for at partikkelen befinner seg i den tilstanden med høyest energi bli større, og det ser man er konsistent med resultatene jeg har fått. Ved høyeste egenenergitilstand er det størst sannsynlighet for å observere partikkelen i tilstanden $\ket{2,2}$, altså med alle partiklene plassert i $\sigma = +1$. På grunn av vekselvirkningen vil det derimot være en viss sannsynlighet for å observere partikkelen i $\ket{2,0}$ og $\ket{2,-2}$ også.


\section{En ny basis}

Oppgaveteksten definerer nå en ny enpartikkeltilstand $\ket{\phi_{\alpha,p}}$ definert ut fra en unitær transformasjon på de opprinnelige enpartikkeltilstandene $\ket{u_{\sigma,p}}$:
\begin{equation}
\ket{\phi_{\alpha,p}} = \sum_{\sigma = \pm 1} C_{\alpha \sigma} \ket{u_{\sigma,p}}.
\label{eq:ut}
\end{equation}
%
De nye tilstandene skrives altså som en lineærkombinasjon av de gamle tilstandene (med $p$ fast). Dermed kan ikke $p$ være noe annet for de nye tilstandene, siden de skrives som en lineærkombinasjon av tilstander som har samme verdi for $p$.

Jeg skal så vise at basisen er ortogonal. Det gjør jeg ved å vise at $\braket{\phi_{\alpha',p'}}{\phi_{\alpha,p}} = \delta_{\alpha \alpha'} \delta_{pp'}$:
\begin{align*}
\braket{\phi_{\alpha',p'}}{\phi_{\alpha,p}}
%
&= \left( \sum_{\sigma' = \pm 1} C_{\alpha' \sigma'} \ket{u_{\sigma',p'}} \right)^\dagger
\left( \sum_{\sigma = \pm 1} C_{\alpha \sigma} \ket{u_{\sigma,p}} \right) \\
%
&= \sum_{\sigma,\sigma' = \pm 1} C_{\alpha' \sigma'}^* C_{\alpha \sigma} \braket{u_{\sigma',p'}}{u_{\sigma,p}} \\
%
&= \sum_{\sigma,\sigma' = \pm 1} C_{\alpha' \sigma'}^* C_{\alpha \sigma} \delta_{\sigma \sigma'} \delta_{pp'} \\
%
&= \delta_{pp'} \sum_{\sigma = \pm 1} C_{\alpha' \sigma}^* C_{\alpha \sigma}.  \\
\end{align*}
%
Det faktum at transformasjonen i ligning \eqref{eq:ut} er unitær, gir at koeffisientene $C_{\alpha \sigma}$ oppfyller følgende betingelse:
\[ C^\dagger C = I_2 \quad \Rightarrow \quad \sum_{\sigma=\pm 1} C_{\alpha' \sigma}^* C_{\alpha \sigma} = \delta_{\alpha \alpha'}, \]
da kolonnene i matrisen $C$ vil være ortonormale. Ved å benytte dette over, får jeg
\begin{equation}
\braket{\phi_{\alpha',p'}}{\phi_{\alpha,p}} = \delta_{\alpha \alpha'} \delta_{pp'},
\label{eq:orto}
\end{equation}
og beviset er dermed fullført.


\section{Slaterdeterminanten med den nye basisen}

Denne oppgaven skulle vi hoppe over.


\section{Forventningsverdien til energien}

En ny Slaterdeterminant konstruert ved hjelp av de nye tilstandene kan nå konstrueres slik:
\begin{equation}
\ket{\Psi} = \prod_{p=1}^4 b_{\alpha,p}^\dagger \ket{0}.
\label{eq:SDny}
\end{equation}
%
Jeg må uttrykker $b_{\alpha,p}^\dagger$ ved hjelp av $a_{p,\sigma}^\dagger$:
\[ \ket{\phi_{\alpha,p}} = b_{\alpha,p}^\dagger \ket{0} =
\sum_{\sigma = \pm 1} C_{\alpha \sigma} \ket{u_{\sigma,p}} =
\sum_{\sigma = \pm 1} C_{\alpha \sigma} a_{p\sigma}^\dagger \ket{0} =
\left( C_{\alpha +} a_{p+}^\dagger + C_{\alpha -} a_{p-}^\dagger \right) \ket{0}. \]
%
Jeg gjenkjenner dette som en operatorligning, og identifiserer
\begin{equation}
b_{\alpha,p}^\dagger = C_{\alpha +} a_{p+}^\dagger + C_{\alpha -} a_{p-}^\dagger,
\quad
b_{\alpha,p} = C_{\alpha +}^* a_{p+} + C_{\alpha -}^* a_{p-}.
\label{eq:b}
\end{equation}
%
Jeg skal i denne oppgaven beregne $E = \bra{\Psi} H \ket{\Psi}$, hvor $\ket{\Psi}$ er gitt ved ligning \eqref{eq:SDny}. Jeg setter derfor inn for $\bra{\Psi}$ og $\ket{\Psi}$ ved hjelp av nevnte ligning, for $H$ ved å bruke ligning \eqref{eq:H} til \eqref{eq:H2} og for $b_{\alpha,p}$ og $b_{\alpha,p}^\dagger$ ved å bruke ligning \eqref{eq:b}. Det gir
\[ E = \bra{\Psi} H \ket{\Psi} =
\bra{\Psi} H_0 \ket{\Psi} + \bra{\Psi} H_1 \ket{\Psi} + \bra{\Psi} H_2 \ket{\Psi}. \]
%
Jeg regner ut leddene hver for seg for enkelhets skyld:
\begin{align*}
\bra{\Psi} H_0 \ket{\Psi} &=
%
\bra{0} b_{\alpha,4} b_{\alpha,3} b_{\alpha,2} b_{\alpha,1}
H_0
b_{\alpha,1}^\dagger b_{\alpha,2}^\dagger b_{\alpha,3}^\dagger b_{\alpha,4}^\dagger \ket{0} \\
%
&= \frac{1}{2} \varepsilon \bra{0}
b_{\alpha,4}
b_{\alpha,3}
b_{\alpha,2}
b_{\alpha,1}
\sum_{p,\sigma} \left[ \sigma a_{p\sigma}^{\dagger}a_{p\sigma} \right]
b_{\alpha,1}^\dagger
b_{\alpha,2}^\dagger
b_{\alpha,3}^\dagger
b_{\alpha,4}^\dagger
\ket{0} \\
%
&= \frac{1}{2} \varepsilon \sum_{p}
\bra{0}
\left( C_{\alpha +}^* a_{4+} + C_{\alpha -}^* a_{4-} \right)
\left( C_{\alpha +}^* a_{3+} + C_{\alpha -}^* a_{3-} \right)
\left( C_{\alpha +}^* a_{2+} + C_{\alpha -}^* a_{2-} \right) \times \\
&\quad\,\,
\left( C_{\alpha +}^* a_{1+} + C_{\alpha -}^* a_{1-} \right)
\left[ a_{p+}^{\dagger}a_{p+} - a_{p-}^{\dagger}a_{p-} \right]
\left( C_{\alpha +} a_{1+}^\dagger + C_{\alpha -} a_{1-}^\dagger \right) \times \\
&\quad\,\,
\left( C_{\alpha +} a_{2+}^\dagger + C_{\alpha -} a_{2-}^\dagger \right)
\left( C_{\alpha +} a_{3+}^\dagger + C_{\alpha -} a_{3-}^\dagger \right)
\left( C_{\alpha +} a_{4+}^\dagger + C_{\alpha -} a_{4-}^\dagger \right)
\ket{0}.
\end{align*}
%
Ser så på tilfellet $p = 1$ og $\sigma = +1$ for å gjøre det litt enklere for meg selv. Det leddet blir
\[ \bra{0}
\left( C_{\alpha +}^* a_{4+} + C_{\alpha -}^* a_{4-} \right)
\left( C_{\alpha +}^* a_{3+} + C_{\alpha -}^* a_{3-} \right)
\left( C_{\alpha +}^* a_{2+} + C_{\alpha -}^* a_{2-} \right)
\left( C_{\alpha +}^* a_{1+} + C_{\alpha -}^* a_{1-} \right) \times \]
\[
\left[ a_{1+}^{\dagger}a_{1+} \right]
\left( C_{\alpha +} a_{1+}^\dagger + C_{\alpha -} a_{1-}^\dagger \right)
\left( C_{\alpha +} a_{2+}^\dagger + C_{\alpha -} a_{2-}^\dagger \right)
\left( C_{\alpha +} a_{3+}^\dagger + C_{\alpha -} a_{3-}^\dagger \right)\times \]
\[ \left( C_{\alpha +} a_{4+}^\dagger + C_{\alpha -} a_{4-}^\dagger \right)
\ket{0}. \]
%
Jeg bruker så Wicks teorem. Siden det her er like mange $a^\dagger$ som $a$, er det kun leddene der alle operatorene er kontrahert som blir ulik $0$. Da kan jeg også droppe normalordensymbolet siden jeg ikke sitter igjen med noen operatorer til slutt.  I tillegg må $a_{1+}$ inne i klammeparantesen kontraheres med $a_{1+}^\dagger$ til høyre, og alle ledd som da inneholder $a_{1-}^\dagger$ istedenfor vil bli $0$. Det gir at leddet over kan skrives
\[ \bra{0}
\left( C_{\alpha +}^* a_{4+} + C_{\alpha -}^* a_{4-} \right)
\left( C_{\alpha +}^* a_{3+} + C_{\alpha -}^* a_{3-} \right)
\left( C_{\alpha +}^* a_{2+} + C_{\alpha -}^* a_{2-} \right)
\left( C_{\alpha +}^* a_{1+}^{\bullet \bullet} \right) \times \]
\[
\left[ a_{1+}^{\dagger \bullet \bullet} a_{1+}^\bullet \right]
\left( C_{\alpha +} a_{1+}^{\dagger \bullet} \right)
\left( C_{\alpha +} a_{2+}^\dagger + C_{\alpha -} a_{2-}^\dagger \right)
\left( C_{\alpha +} a_{3+}^\dagger + C_{\alpha -} a_{3-}^\dagger \right)\times \]
\[ \left( C_{\alpha +} a_{4+}^\dagger + C_{\alpha -} a_{4-}^\dagger \right)
\ket{0}. \]
%
Her har jeg brukt notasjonen at $a_{1+}^\bullet$ kontraheres med $a_{1+}^{\dagger \bullet}$ og så videre. Legg merke til at her skal det egentlig være kontraksjoner også på resten av operatorene, men jeg ser ikke på dem foreløpig, og derfor har jeg utelatt dem. Denne notasjonen kommer jeg til å bruke i resten av oppgaven. Da sitter jeg igjen med
\[ C_{\alpha +}^* C_{\alpha +} \bra{0}
\left( C_{\alpha +}^* a_{4+} + C_{\alpha -}^* a_{4-} \right)
\left( C_{\alpha +}^* a_{3+} + C_{\alpha -}^* a_{3-} \right)
\left( C_{\alpha +}^* a_{2+}^\bullet + C_{\alpha -}^* a_{2-}^{\bullet \bullet} \right) \times \]
\[
\left( C_{\alpha +} a_{2+}^{\dagger \bullet} + C_{\alpha -} a_{2-}^{\dagger \bullet \bullet} \right)
\left( C_{\alpha +} a_{3+}^\dagger + C_{\alpha -} a_{3-}^\dagger \right)
\left( C_{\alpha +} a_{4+}^\dagger + C_{\alpha -} a_{4-}^\dagger \right)
\ket{0}, \]
%
hvor jeg har satt på to kontraksjoner til som er eneste mulighet for at leddet skal bli ulik $0$. Dette gir at dette leddet blir
\[ |C_{\alpha +}|^2 \bra{0}
\left( C_{\alpha +}^* a_{4+} + C_{\alpha -}^* a_{4-} \right)
\left( C_{\alpha +}^* a_{3+} + C_{\alpha -}^* a_{3-} \right)
\left( C_{\alpha +}^* C_{\alpha +} + C_{\alpha -}^* C_{\alpha -} \right) \times \]
\[
\left( C_{\alpha +} a_{3+}^\dagger + C_{\alpha -} a_{3-}^\dagger \right)
\left( C_{\alpha +} a_{4+}^\dagger + C_{\alpha -} a_{4-}^\dagger \right)
\ket{0}. \]
Dette skjer fordi ledd med $a_{2+}^\bullet a_{2-}^{\dagger \bullet}$ og tilsvarende vil gi $0$. Så husker jeg at matrisen $C$ er unitær, slik at $C_{\alpha +}^* C_{\alpha +} + C_{\alpha -}^* C_{\alpha -} = 1$. Altså sitter jeg igjen med
\[ |C_{\alpha +}|^2 \bra{0}
\left( C_{\alpha +}^* a_{4+} + C_{\alpha -}^* a_{4-} \right)
\left( C_{\alpha +}^* a_{3+}^\bullet + C_{\alpha -}^* a_{3-}^{\bullet \bullet} \right) \times \]
\[
\left( C_{\alpha +} a_{3+}^{\dagger \bullet} + C_{\alpha -} a_{3-}^{\dagger \bullet \bullet} \right)
\left( C_{\alpha +} a_{4+}^\dagger + C_{\alpha -} a_{4-}^\dagger \right)
\ket{0}. \]
%
Igjen vil det samme skje, noe som betyr at at hele dette leddet vil bli til $|C_{\alpha +}|^2$. Jeg går så videre til neste ledd som dannes på grunn av summen i $H_0$ ($p = 2$, $\sigma = +1$). Her vil det samme skje, men forskjellen er nå at jeg må permutere $a_{2+}^\dagger$ på høyre side for å få kontrahert den med $a_{2+}$ fra $H_0$. Det vil føre til et fortegnsskifte, men jeg må på tilsvarende måte måtte permutere $a_{2-}$ på venstre side for å kunne kontrahere den med $a_{2+}^\dagger$ fra $H_0$. Dette vil føre til nøyaktig like mange permutasjoner, og totalt blir det dermed ikke noe fortegnsskifte. Etter disse to kontraksjonene, vil de resterende gi $0$ som før, og jeg står også nå igjen med $|C_{\alpha +}|^2$.

Av dette ser jeg at leddene i $H_0$ som inneholder $\sigma = +1$ alle vil bidra med leddet $|C_{\alpha +}|^2$, mens alle ledd fra $H_0$ som inneholder $\sigma = -1$ vil bidra med $-|C_{\alpha -}|^2$ (på grunn av $-$-tegnet foran $a_{p-}^\dagger a_{p-}$ i $H_0$). Dermed kan jeg trekke konklusjonen
\begin{equation}
\bra{\Psi} H_0 \ket{\Psi} = \frac{1}{2} \varepsilon \left( 4|C_{\alpha +}|^2 - 4|C_{\alpha -}|^2 \right) = 2\varepsilon |C_{\alpha +}|^2 - 2 \varepsilon |C_{\alpha -}|^2.
\label{eq:PsiH0Psi}
\end{equation}
%
Jeg går så videre til $\bra{\Psi} H_1 \ket{\Psi}$. Her får jeg:
\begin{align*}
\bra{\Psi} H_1 \ket{\Psi} &=
%
\bra{0} b_{\alpha,4} b_{\alpha,3} b_{\alpha,2} b_{\alpha,1}
H_1
b_{\alpha,1}^\dagger b_{\alpha,2}^\dagger b_{\alpha,3}^\dagger b_{\alpha,4}^\dagger \ket{0} \\
%
&= \frac{1}{2} V \bra{0}
b_{\alpha,4}
b_{\alpha,3}
b_{\alpha,2}
b_{\alpha,1}
\sum_{p,p',\sigma} \left[ a_{p\sigma}^\dagger a_{p'\sigma}^\dagger a_{p'-\sigma} a_{p-\sigma} \right]
b_{\alpha,1}^\dagger
b_{\alpha,2}^\dagger
b_{\alpha,3}^\dagger
b_{\alpha,4}^\dagger
\ket{0} \\
%
&= \frac{1}{2} V \sum_{p,p'}
\bra{0}
\left( C_{\alpha +}^* a_{4+} + C_{\alpha -}^* a_{4-} \right)
\left( C_{\alpha +}^* a_{3+} + C_{\alpha -}^* a_{3-} \right)
\left( C_{\alpha +}^* a_{2+} + C_{\alpha -}^* a_{2-} \right) \times \\
&\quad\,\,
\left( C_{\alpha +}^* a_{1+} + C_{\alpha -}^* a_{1-} \right)
\left[ a_{p+}^\dagger a_{p'+}^\dagger a_{p'-} a_{p-} + a_{p-}^\dagger a_{p'-}^\dagger a_{p'+} a_{p+} \right]
\left( C_{\alpha +} a_{1+}^\dagger + C_{\alpha -} a_{1-}^\dagger \right) \times \\
&\quad\,\,
\left( C_{\alpha +} a_{2+}^\dagger + C_{\alpha -} a_{2-}^\dagger \right)
\left( C_{\alpha +} a_{3+}^\dagger + C_{\alpha -} a_{3-}^\dagger \right)
\left( C_{\alpha +} a_{4+}^\dagger + C_{\alpha -} a_{4-}^\dagger \right)
\ket{0}.
\end{align*}
%
Jeg går nå frem på samme måte som for $H_0$. Nå er det derimot en ekstra komplikasjon på grunn av at det skal summeres over både $p$ og $p'$. Igjen tar jeg ut et ledd og ser mer spesielt på det, men først legger jeg merke til at $p = p'$ gir ledd som blir $0$. Det skjer fordi det da står to $a_{p\pm}$ inne i klammeparantesen, men det er bare en $a_{p\pm}^\dagger$ tilgjengelig til høyre å kontrahere den med for å få et ledd ulik $0$. Altså blir den andre tvunget til å kontraheres med et annet ledd som vil gi $0$. Jeg ser derfor først på følgende ledd ($p = 1$, $p' = 2$, $\sigma = +1$):
\[ \bra{0}
\left( C_{\alpha +}^* a_{4+} + C_{\alpha -}^* a_{4-} \right)
\left( C_{\alpha +}^* a_{3+} + C_{\alpha -}^* a_{3-} \right)
\left( C_{\alpha +}^* a_{2+}^{\bullet \bullet} + C_{\alpha -}^* a_{2-} \right)
\left( C_{\alpha +}^* a_{1+}^\bullet + C_{\alpha -}^* a_{1-} \right) \times \]
\[
\left[ a_{1+}^{\dagger \bullet} a_{2+}^{\dagger \bullet \bullet} a_{2-}^{\bullet \bullet \bullet} a_{1-}^{\bullet \bullet \bullet \bullet} \right]
\left( C_{\alpha +} a_{1+}^\dagger + C_{\alpha -} a_{1-}^{\dagger \bullet \bullet \bullet \bullet} \right)
\left( C_{\alpha +} a_{2+}^\dagger + C_{\alpha -} a_{2-}^{\dagger \bullet \bullet \bullet} \right)
\left( C_{\alpha +} a_{3+}^\dagger + C_{\alpha -} a_{3-}^\dagger \right)\times \]
\[ \left( C_{\alpha +} a_{4+}^\dagger + C_{\alpha -} a_{4-}^\dagger \right)
\ket{0}, \]
hvor jeg har notert på kontraksjonene som gir ledd ulik $0$ (bruker igjen Wicks teorem og innser at alle operatorer må kontraheres for å få ledd ulik $0$). Jeg innser også at leddene med $a_{1+}^\dagger$ og $a_{2+}^\dagger$ til fra høyre, og $a_{1-}$ og $a_{2-}$ fra venstre vil gi ledd som blir $0$ fordi kontraksjonene mellom disse operatorene og de som står inne i klammeparantesen gir $0$. For akkurat dette leddet er det ikke noe fortegnsskifte siden ingen permuteringer er nødvendig før kontraksjonene kan begynne. Dette gir at leddet over blir:
\[ \bra{0}
\left( C_{\alpha +}^* a_{4+} + C_{\alpha -}^* a_{4-} \right)
\left( C_{\alpha +}^* a_{3+} + C_{\alpha -}^* a_{3-} \right)
\left[ C_{\alpha +}^* C_{\alpha +}^* \times C_{\alpha -} C_{\alpha -} \right]
\left( C_{\alpha +} a_{3+}^\dagger + C_{\alpha -} a_{3-}^\dagger \right) \times \]
\[ \left( C_{\alpha +} a_{4+}^\dagger + C_{\alpha -} a_{4-}^\dagger \right)
\ket{0}. \]
Det som nå står inne i klammeparantesen er konstant og kan flyttes utenfor, mens det det som da står igjen er nøyaktig det samme som stod igjen når jeg så på leddet inneholdt i $\bra{\Psi} H_0 \ket{\Psi}$, og da fant jeg ut at det ble $1$. Altså vil dette leddet bli $(C_{\alpha +}^*)^2 (C_{\alpha -})^2$.

Nå er det ikke så veldig vanskelig å innse at uansett hva $p$ og $p'$ er, vil nøyaktig det samme leddet komme frem i summen over $p$ og $p'$ gitt $\sigma = +1$. Dette ser jeg på samme måte som da jeg regnet ut $\bra{\Psi} H_0 \ket{\Psi}$, og fortsatt vil alle ledd bli positive av nøyaktig samme begrunnelse som tidligere. Det er totalt $4 \times 3 = 12$ mulige verdier for settet $(p,p')$ fordi $p = p'$ ikke skal være med (det gav $0$). Dette gir at det totale bidraget fra $\sigma = +1$ er $12(C_{\alpha +}^*)^2 (C_{\alpha -})^2$.

Videre ser jeg på $\sigma = -1$. Eneste forskjellen i utregningen over blir da at $a_{1+}$ og $a_{2+}$ som nå står inne i klammeparantesen skal kontraheres med $a_{1+}^\dagger$ og $a_{2+}^\dagger$ til høyre. Det tilsvarende skjer for $a_{1-}^\dagger$ og $a_{2-}^\dagger$ inne i klammeparantesen. Det gir at jeg sitter igjen med $(C_{\alpha +})^2 (C_{\alpha -}^*)^2$ for $\sigma = -1$ (hva som er komplekskonjugert blir byttet om). Igjen er det $12$ mulige kombinasjoner, som gir totalt bidrag $12(C_{\alpha +})^2 (C_{\alpha -}^*)^2$. Jeg har derfor
\begin{equation}
\bra{\Psi} H_1 \ket{\Psi} = \frac{1}{2} V \left( 12(C_{\alpha +}^*)^2 (C_{\alpha -})^2 + 12(C_{\alpha +})^2 (C_{\alpha -}^*)^2 \right).
\label{eq:PsiH1Psi}
\end{equation}
%
Jeg går så videre til det siste leddet:
\begin{align*}
\bra{\Psi} H_2 \ket{\Psi} &=
%
\bra{0} b_{\alpha,4} b_{\alpha,3} b_{\alpha,2} b_{\alpha,1}
H_2
b_{\alpha,1}^\dagger b_{\alpha,2}^\dagger b_{\alpha,3}^\dagger b_{\alpha,4}^\dagger \ket{0} \\
%
&= \frac{1}{2} W \bra{0}
b_{\alpha,4}
b_{\alpha,3}
b_{\alpha,2}
b_{\alpha,1}
\sum_{p,p',\sigma} \left[ a_{p\sigma}^\dagger a_{p'-\sigma}^\dagger a_{p'\sigma}a_{p-\sigma} \right]
b_{\alpha,1}^\dagger
b_{\alpha,2}^\dagger
b_{\alpha,3}^\dagger
b_{\alpha,4}^\dagger
\ket{0} \\
%
&= \frac{1}{2} W \sum_{p,p'}
\bra{0}
\left( C_{\alpha +}^* a_{4+} + C_{\alpha -}^* a_{4-} \right)
\left( C_{\alpha +}^* a_{3+} + C_{\alpha -}^* a_{3-} \right)
\left( C_{\alpha +}^* a_{2+} + C_{\alpha -}^* a_{2-} \right) \times \\
&\quad\,\,
\left( C_{\alpha +}^* a_{1+} + C_{\alpha -}^* a_{1-} \right)
\left[ a_{p+}^\dagger a_{p'-}^\dagger a_{p'+}a_{p-} + a_{p-}^\dagger a_{p'+}^\dagger a_{p'-}a_{p+} \right]
\left( C_{\alpha +} a_{1+}^\dagger + C_{\alpha -} a_{1-}^\dagger \right) \times \\
&\quad\,\,
\left( C_{\alpha +} a_{2+}^\dagger + C_{\alpha -} a_{2-}^\dagger \right)
\left( C_{\alpha +} a_{3+}^\dagger + C_{\alpha -} a_{3-}^\dagger \right)
\left( C_{\alpha +} a_{4+}^\dagger + C_{\alpha -} a_{4-}^\dagger \right)
\ket{0}.
\end{align*}
%
Igjen bruker jeg Wicks teorem og innser at alle ledd med $p = p'$ gir $0$ av samme begrunnelse som isted. Velger så ut leddet $p = 1$, $p' = 2$, $\sigma = +1$, og ser på det på samme måte som tidligere:
\[ \bra{0}
\left( C_{\alpha +}^* a_{4+} + C_{\alpha -}^* a_{4-} \right)
\left( C_{\alpha +}^* a_{3+} + C_{\alpha -}^* a_{3-} \right)
\left( C_{\alpha +}^* a_{2+} + C_{\alpha -}^* a_{2-}^{\bullet \bullet} \right)
\left( C_{\alpha +}^* a_{1+}^\bullet + C_{\alpha -}^* a_{1-} \right) \times \]
\[
\left[ a_{1+}^{\dagger \bullet} a_{2-}^{\dagger \bullet \bullet} a_{2+}^{\bullet \bullet \bullet} a_{1-}^{\bullet \bullet \bullet \bullet} \right]
\left( C_{\alpha +} a_{1+}^\dagger + C_{\alpha -} a_{1-}^{\dagger \bullet \bullet \bullet \bullet} \right)
\left( C_{\alpha +} a_{2+}^{\dagger \bullet \bullet \bullet} + C_{\alpha -} a_{2-}^\dagger \right)
\left( C_{\alpha +} a_{3+}^\dagger + C_{\alpha -} a_{3-}^\dagger \right)\times \]
\[ \left( C_{\alpha +} a_{4+}^\dagger + C_{\alpha -} a_{4-}^\dagger \right)
\ket{0}, \]
hvor jeg igjen har markert eneste mulige kontraksjoner som gir ledd ulik $0$. Igjen følger helt lik begrunnelse: Jeg utfører kontraksjonene vist og får en konstant inne i klammeparantesen. Denne trekker jeg utenfor og får det som står igjen inne i braketen lik $1$. Altså blir leddet det som står igjen inne i braketen etter kontraksjonene, som er $C_{\alpha -}^* C_{\alpha +}^* C_{\alpha -} C_{\alpha +} = |C_{\alpha +}|^2 |C_{\alpha -}|^2$.

Jeg gå så over til å se på hva som skjer dersom $p = 1$, $p' = 3$, $\sigma = +1$. Da blir argumentasjonen som før, jeg må utføre kontraksjonene som jeg nettopp gjorde, men noen operatorer må permuteres før kontraksjonen kan utføres. Det blir derimot alltid utført et like antall permutasjoner, som gir positivt fortegn. Altså står jeg igjen med samme ledd som for $p = 1$, $p' = 2$, $\sigma = +1$. Akkurat det samme vil skje med alle andre mulige verdier for $p$ og $p'$ for $\sigma = +1$, og totalt gir det $4 \times 3 = 12$ mulige valg for $p$ og $p'$. Bidraget fra $\sigma = +1$ blir derfor $12|C_{\alpha +}|^2 |C_{\alpha -}|^2$.

For $\sigma = -1$ er det forholdsvis greit å se at bidraget blir det samme. Legg merke til at i $H_2$ kan jeg bytte om både de to adjungerte operatorene og de to ikke-adjungerte operatorene og få tilbake det samme som jeg hadde da $\sigma = +1$ ved å bruke antikommutasjonsrelasjonene. Fortegnet blir ikke byttet om fordi jeg gjør to ombytter. Dette gir at det totale bidraget fra $H_2$ blir:
\begin{equation}
\bra{\Psi} H_2 \ket{\Psi} = 12W|C_{\alpha +}|^2 |C_{\alpha -}|^2.
\label{eq:PsiH2Psi}
\end{equation}
%
Nå kan jeg oppsummere resultatet ved å bruke ligning \eqref{eq:PsiH0Psi}, \eqref{eq:PsiH1Psi} og \eqref{eq:PsiH2Psi}. Det gir:
\begin{equation}
\begin{gathered}
E = \bra{\Psi} H \ket{\Psi} = 2\varepsilon |C_{\alpha +}|^2 - 2 \varepsilon |C_{\alpha -}|^2 + \\
\frac{1}{2} V \left( 12(C_{\alpha +}^*)^2 (C_{\alpha -})^2 + 12(C_{\alpha +})^2 (C_{\alpha -}^*)^2 \right) +
12W|C_{\alpha +}|^2 |C_{\alpha -}|^2 .
\end{gathered}
\label{eq:PsiHPsi}
\end{equation}
%
Så har jeg fått oppgitt at jeg skal anta at $C_{\alpha \pm}$ er reelle, noe som betyr at $C_{\alpha \pm}^* = C_{\alpha \pm}$. Det gir
\begin{equation}
E = \bra{\Psi} H \ket{\Psi} = 2\varepsilon C_{\alpha +}^2 - 2 \varepsilon C_{\alpha -}^2 +
12 (V+W) C_{\alpha +}^2 C_{\alpha -}^2 .
\label{eq:PsiHPsiReell}
\end{equation}


\section{Minimumsenergien og krav til parametere}

Jeg benytter resultatet fra forrige oppgave gitt i ligning \eqref{eq:PsiHPsiReell}, og siden jeg vet at $C_{\alpha +}$ og $C_{\alpha -}$ er reelle og at tilstanden $\ket{\phi_{\alpha,p}}$ er normert, har jeg sammenhengen $C_{\alpha +}^2 + C_{\alpha -}^2 = 1$. Det gir at jeg har
\[ E = 2\varepsilon (1 - C_{\alpha -}^2) - 2 \varepsilon C_{\alpha -}^2 +
12 (V+W) (1 - C_{\alpha -}^2) C_{\alpha -}^2 . \]
%
For enkelhets skyld setter jeg nå $x = C_{\alpha -}^2$ og minimerer så dette uttrykket. Først deriverer jeg energien med hensyn på $x$:
\begin{align*}
\frac{\partial E}{\partial x} &= \frac{\partial}{\partial x} \left[ 2\varepsilon (1 - x) - 2 \varepsilon x +
12 (V+W) (1 - x) x \right] \\
%
&= -2\varepsilon -2\varepsilon + 12(V+W)(-x + 1-x) \\
%
&= -4 \varepsilon + 12(V+W)(1-2x).
\end{align*}
%
Jeg finner minimum ved å sette uttrykket lik $0$:
\[ \frac{\partial E}{\partial x} = 0 \quad \Rightarrow \quad -4 \varepsilon + 12(V+W)(1-2x) = 0, \]
som gir
\[ -\varepsilon + 3(V+W) = 6(V+W)x \quad \Rightarrow \quad x = \frac{1}{2} - \frac{\varepsilon}{6(V+W)}. \]
Dette gir følgende verdier på $C_{\alpha +}$ og $C_{\alpha -}$:
\begin{equation}
C_{\alpha -}^2 = \frac{1}{2} - \frac{\varepsilon}{6(V+W)}, \quad C_{\alpha +}^2 = 1 - C_{\alpha -}^2 = \frac{1}{2} + \frac{\varepsilon}{6(V+W)}.
\label{eq:Cmin}
\end{equation}
%
Nå har jeg altså funnet lokale minimumspunkter, men det kan godt hende de ligger utenfor løsningsområdet som er begrenset av $0 \leq C_{\alpha -}^2, C_{\alpha +}^2 \leq 1$. Det har jeg ingen garanti for at de ikke gjør. Som alltid når jeg finner minimumspunkter må jeg også ha med randen av det aktuelle løsningsområdet. Det vil si at det globale minimum (innenfor løsningsområdet) godt kan forekomme ved $C_{\alpha -}^2 = 0$ eller $C_{\alpha -}^2 = 1$. For å finne ut hva som er det faktiske minimumspunktet må jeg sette uttrykkene for $C_{\alpha -}^2$ inn i formelen for energien over, og sjekke hva som gir lavest energi, og om minimumspunktene gitt ved at den deriverte av energien er $0$ gir løsninger innenfor løsningsområdet.

Dersom minimumspunktet for energien funnet ved å derivere ligger innenfor løsningsområdet, vil jeg kunne sette inn ligningen for $C_{\alpha -}^2$ over inn i ulikheten $0 \leq C_{\alpha -}^2 \leq 1$. Dette gir følgende uttrykk:
\[ 0 \leq \frac{1}{2} - \frac{\varepsilon}{6(V+W)} \leq 1, \]
som etter litt omstokkingsarbied gir
\begin{equation}
(V+W) \leq \frac{\varepsilon}{3} \leq - (V+W),
\label{eq:C-ineq}
\end{equation}
hvor jeg har forutsatt at $V + W < 0$. Dersom $V + W > 0$, vil bare retningen på ulikhetstegnene byttes om. Tilsvarende kunne jeg satt uttrykket for $C_{\alpha +}$ inn i den tilsvarende ulikheten for $C_{\alpha +}$, men jeg får da naturlig nok akkurat samme ulikheter som i ligning \eqref{eq:C-ineq}.

Ved hjelp av variasjonsprinsippet kan jeg dermed finne et estimat for grunntilstandsenergien til systemet ved å putte inn $C_{\alpha +}$ og $C_{\alpha -}$ i ligning \eqref{eq:PsiHPsiReell}. Siden jeg vet at grunntilstandsenergien alltid vil være mindre enn eller lik forventningsverdien til Hamiltonoperatoren (for en vilkårlig bølgefunksjon), vil jeg kunne putte inn de verdiene for $C_{\alpha +}$ og $C_{\alpha -}$ som gir den minste energien i ligning \eqref{eq:PsiHPsiReell} og si at den egentlige grunntilstandsenergien ihvertfall ikke er større enn det. Jeg kan naturlig nok ikke putte inn verdier som ikke oppfyller $0 \leq C_{\alpha -}^2, C_{\alpha +}^2 \leq 1$ siden den aktuelle transformasjonen da ikke vil være en unitær transformasjon som jeg har tatt utgangspunkt i da jeg regnet ut formelen for energien gitt ved ligning \eqref{eq:PsiHPsiReell}.

\end{document}
